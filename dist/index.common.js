"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.VXETablePluginCharts = void 0;

var _xeUtils = _interopRequireDefault(require("xe-utils/methods/xe-utils"));

var echarts = _interopRequireWildcard(require("echarts/lib/echarts"));

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { "default": obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj["default"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function createChartModal(getOptions) {
  return function (params) {
    var $table = params.$table,
        menu = params.menu;
    var chartModals = $table.chartModals;

    if (!chartModals) {
      chartModals = $table.chartModals = [];
    }

    var opts = {
      id: _xeUtils["default"].uniqueId(),
      resize: true,
      mask: false,
      lockView: false,
      showFooter: false,
      width: 600,
      height: 400,
      title: menu.name,
      slots: {
        "default": function _default(params, h) {
          return [h('div', {
            "class": 'vxe-chart--wrapper'
          }, [h('div', {
            "class": 'vxe-chart--panel'
          })])];
        }
      },
      events: {
        show: function show(_ref) {
          var $modal = _ref.$modal;
          var $chart = echarts.init($modal.$el.querySelector('.vxe-chart--wrapper'));
          $chart.setOption(getOptions(params));
          $modal.$chart = $chart;
        },
        close: function close(_ref2) {
          var $modal = _ref2.$modal;

          // 旧版本，即将废弃
          _xeUtils["default"].remove(chartModals, function (id) {
            return id === $modal.id;
          });

          $modal.$chart.dispose();
          $modal.$chart = null;
        },
        hide: function hide(_ref3) {
          var $modal = _ref3.$modal;

          _xeUtils["default"].remove(chartModals, function (id) {
            return id === $modal.id;
          });

          $modal.$chart.dispose();
          $modal.$chart = null;
        },
        zoom: function zoom(_ref4) {
          var $modal = _ref4.$modal;
          $modal.$chart.resize();
        }
      }
    };
    chartModals.push(opts.id);

    if (this.$XModal.open) {
      this.$XModal.open(opts);
    } else {
      // 旧版本，即将废弃
      this.$XModal(opts);
    }
  };
}

var menuMap = {
  CHART_BAR_X_AXIS: createChartModal(function (params) {
    var $table = params.$table,
        menu = params.menu;

    var _ref5 = $table.getSelectedRanges ? $table.getSelectedRanges() : $table.getMouseCheckeds(),
        rows = _ref5.rows,
        columns = _ref5.columns;

    var _menu$params = menu.params,
        chartParams = _menu$params === void 0 ? {} : _menu$params;
    var category = chartParams.category;
    var categoryColumn = $table.getColumnByField(category || columns[0].property);
    var serieColumns = columns.filter(function (column) {
      return column.property !== categoryColumn.property;
    });
    var legendOpts = {
      data: []
    };
    var seriesOpts = [];
    var xAxisOpts = {
      type: 'category',
      data: rows.map(function (row) {
        return _xeUtils["default"].get(row, categoryColumn.property);
      })
    };
    serieColumns.forEach(function (column) {
      legendOpts.data.push(column.title);
      seriesOpts.push({
        name: column.title,
        type: 'bar',
        data: rows.map(function (row) {
          return _xeUtils["default"].get(row, column.property);
        })
      });
    });
    var option = {
      tooltip: {
        trigger: 'axis',
        axisPointer: {
          type: 'shadow'
        }
      },
      legend: legendOpts,
      xAxis: xAxisOpts,
      yAxis: {
        type: 'value'
      },
      series: seriesOpts
    };
    return option;
  }),
  CHART_BAR_Y_AXIS: createChartModal(function (params) {
    var $table = params.$table,
        menu = params.menu;

    var _ref6 = $table.getSelectedRanges ? $table.getSelectedRanges() : $table.getMouseCheckeds(),
        rows = _ref6.rows,
        columns = _ref6.columns;

    var _menu$params2 = menu.params,
        chartParams = _menu$params2 === void 0 ? {} : _menu$params2;
    var category = chartParams.category;
    var categoryColumn = $table.getColumnByField(category || columns[0].property);
    var serieColumns = columns.filter(function (column) {
      return column.property !== categoryColumn.property;
    });
    var legendOpts = {
      data: []
    };
    var seriesOpts = [];
    var xAxisOpts = {
      type: 'category',
      data: rows.map(function (row) {
        return _xeUtils["default"].get(row, categoryColumn.property);
      })
    };
    serieColumns.forEach(function (column) {
      legendOpts.data.push(column.title);
      seriesOpts.push({
        name: column.title,
        type: 'bar',
        data: rows.map(function (row) {
          return _xeUtils["default"].get(row, column.property);
        })
      });
    });
    var option = {
      tooltip: {
        trigger: 'axis',
        axisPointer: {
          type: 'shadow'
        }
      },
      legend: legendOpts,
      xAxis: xAxisOpts,
      yAxis: {
        type: 'value'
      },
      series: seriesOpts
    };
    return option;
  }),
  CHART_LINE: createChartModal(function (params) {
    var $table = params.$table,
        menu = params.menu;

    var _ref7 = $table.getSelectedRanges ? $table.getSelectedRanges() : $table.getMouseCheckeds(),
        rows = _ref7.rows,
        columns = _ref7.columns;

    var _menu$params3 = menu.params,
        chartParams = _menu$params3 === void 0 ? {} : _menu$params3;
    var category = chartParams.category;
    var categoryColumn = $table.getColumnByField(category || columns[0].property);
    var serieColumns = columns.filter(function (column) {
      return column.property !== categoryColumn.property;
    });
    var legendOpts = {
      data: []
    };
    var seriesOpts = [];
    var xAxisOpts = {
      type: 'category',
      data: rows.map(function (row) {
        return _xeUtils["default"].get(row, categoryColumn.property);
      })
    };
    serieColumns.forEach(function (column) {
      legendOpts.data.push(column.title);
      seriesOpts.push({
        name: column.title,
        type: 'line',
        data: rows.map(function (row) {
          return _xeUtils["default"].get(row, column.property);
        })
      });
    });
    var option = {
      tooltip: {
        trigger: 'axis'
      },
      legend: legendOpts,
      toolbox: {
        feature: {
          saveAsImage: {}
        }
      },
      xAxis: xAxisOpts,
      yAxis: {
        type: 'value'
      },
      series: seriesOpts
    };
    return option;
  }),
  CHART_PIE: createChartModal(function (params) {
    var $table = params.$table,
        menu = params.menu;

    var _ref8 = $table.getSelectedRanges ? $table.getSelectedRanges() : $table.getMouseCheckeds(),
        rows = _ref8.rows,
        columns = _ref8.columns;

    var _menu$params4 = menu.params,
        chartParams = _menu$params4 === void 0 ? {} : _menu$params4;
    var category = chartParams.category;
    var categoryColumn = $table.getColumnByField(category || columns[0].property);
    var serieColumns = columns.filter(function (column) {
      return column.property !== categoryColumn.property;
    });
    var serieColumn = serieColumns[0];
    var legendData = rows.map(function (row) {
      return _xeUtils["default"].get(row, categoryColumn.property);
    });
    var seriesData = [];
    rows.forEach(function (row) {
      seriesData.push({
        name: _xeUtils["default"].get(row, categoryColumn.property),
        value: _xeUtils["default"].get(row, serieColumn.property)
      });
    });
    var option = {
      tooltip: {
        trigger: 'item',
        formatter: '{a} <br/>{b} : {c} ({d}%)'
      },
      legend: {
        type: 'scroll',
        orient: 'vertical',
        right: 10,
        top: 20,
        bottom: 20,
        data: legendData // selected: data.selected

      },
      series: [{
        name: serieColumn.title,
        type: 'pie',
        radius: '50%',
        center: ['40%', '50%'],
        data: seriesData
      }]
    };
    return option;
  })
};

function checkPrivilege(item, params) {
  var $table = params.$table;
  var code = item.code,
      _item$params = item.params,
      chartParams = _item$params === void 0 ? {} : _item$params;

  switch (code) {
    case 'CHART_BAR_X_AXIS':
    case 'CHART_BAR_Y_AXIS':
    case 'CHART_LINE':
      {
        var _ref9 = $table.getSelectedRanges ? $table.getSelectedRanges() : $table.getMouseCheckeds(),
            rows = _ref9.rows,
            columns = _ref9.columns;

        var category = chartParams.category;

        if (category) {
          var serieColumns = columns.filter(function (column) {
            return column.property !== category;
          });
          item.disabled = !rows.length || serieColumns.length < 1;
        } else {
          item.disabled = !rows.length || columns.length < 2;
        }
      }
      break;

    case 'CHART_PIE':
      {
        var _ref10 = $table.getSelectedRanges ? $table.getSelectedRanges() : $table.getMouseCheckeds(),
            _rows = _ref10.rows,
            _columns = _ref10.columns;

        var _category = chartParams.category;

        if (_category) {
          var _serieColumns = _columns.filter(function (column) {
            return column.property !== _category;
          });

          item.disabled = !_rows.length || _serieColumns.length !== 1;
        } else {
          item.disabled = !_rows.length || _columns.length !== 2;
        }
      }
      break;
  }
}

function handleBeforeDestroyEvent(_ref11) {
  var $table = _ref11.$table;
  var $XModal = $table.$XModal,
      chartModals = $table.chartModals;

  if (chartModals) {
    if ($XModal.close) {
      chartModals.forEach(function (id) {
        return $XModal.close(id);
      });
    } else {
      // 旧版本，即将废弃
      $XModal.closeAll();
    }
  }
}

function handlePrivilegeEvent(params) {
  params.options.forEach(function (list) {
    list.forEach(function (item) {
      checkPrivilege(item, params);

      if (item.children) {
        item.children.forEach(function (child) {
          checkPrivilege(child, params);
        });
      }
    });
  });
}
/**
 * 基于 vxe-table 表格的图表渲染插件
 */


var VXETablePluginCharts = {
  install: function install(xtable) {
    var interceptor = xtable.interceptor,
        menus = xtable.menus,
        _modal = xtable._modal;

    if (!_modal) {
      throw new Error('[vxe-table-plugin-charts] require Modal module.');
    }

    interceptor.add('beforeDestroy', handleBeforeDestroyEvent);
    interceptor.add('event.showMenu', handlePrivilegeEvent);
    menus.mixin(menuMap);
  }
};
exports.VXETablePluginCharts = VXETablePluginCharts;

if (typeof window !== 'undefined' && window.VXETable) {
  window.VXETable.use(VXETablePluginCharts);
}

var _default2 = VXETablePluginCharts;
exports["default"] = _default2;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbImNyZWF0ZUNoYXJ0TW9kYWwiLCJnZXRPcHRpb25zIiwicGFyYW1zIiwiJHRhYmxlIiwibWVudSIsImNoYXJ0TW9kYWxzIiwib3B0cyIsImlkIiwiWEVVdGlscyIsInVuaXF1ZUlkIiwicmVzaXplIiwibWFzayIsImxvY2tWaWV3Iiwic2hvd0Zvb3RlciIsIndpZHRoIiwiaGVpZ2h0IiwidGl0bGUiLCJuYW1lIiwic2xvdHMiLCJoIiwiZXZlbnRzIiwic2hvdyIsIiRtb2RhbCIsIiRjaGFydCIsImVjaGFydHMiLCJpbml0IiwiJGVsIiwicXVlcnlTZWxlY3RvciIsInNldE9wdGlvbiIsImNsb3NlIiwicmVtb3ZlIiwiZGlzcG9zZSIsImhpZGUiLCJ6b29tIiwicHVzaCIsIiRYTW9kYWwiLCJvcGVuIiwibWVudU1hcCIsIkNIQVJUX0JBUl9YX0FYSVMiLCJnZXRTZWxlY3RlZFJhbmdlcyIsImdldE1vdXNlQ2hlY2tlZHMiLCJyb3dzIiwiY29sdW1ucyIsImNoYXJ0UGFyYW1zIiwiY2F0ZWdvcnkiLCJjYXRlZ29yeUNvbHVtbiIsImdldENvbHVtbkJ5RmllbGQiLCJwcm9wZXJ0eSIsInNlcmllQ29sdW1ucyIsImZpbHRlciIsImNvbHVtbiIsImxlZ2VuZE9wdHMiLCJkYXRhIiwic2VyaWVzT3B0cyIsInhBeGlzT3B0cyIsInR5cGUiLCJtYXAiLCJyb3ciLCJnZXQiLCJmb3JFYWNoIiwib3B0aW9uIiwidG9vbHRpcCIsInRyaWdnZXIiLCJheGlzUG9pbnRlciIsImxlZ2VuZCIsInhBeGlzIiwieUF4aXMiLCJzZXJpZXMiLCJDSEFSVF9CQVJfWV9BWElTIiwiQ0hBUlRfTElORSIsInRvb2xib3giLCJmZWF0dXJlIiwic2F2ZUFzSW1hZ2UiLCJDSEFSVF9QSUUiLCJzZXJpZUNvbHVtbiIsImxlZ2VuZERhdGEiLCJzZXJpZXNEYXRhIiwidmFsdWUiLCJmb3JtYXR0ZXIiLCJvcmllbnQiLCJyaWdodCIsInRvcCIsImJvdHRvbSIsInJhZGl1cyIsImNlbnRlciIsImNoZWNrUHJpdmlsZWdlIiwiaXRlbSIsImNvZGUiLCJkaXNhYmxlZCIsImxlbmd0aCIsImhhbmRsZUJlZm9yZURlc3Ryb3lFdmVudCIsImNsb3NlQWxsIiwiaGFuZGxlUHJpdmlsZWdlRXZlbnQiLCJvcHRpb25zIiwibGlzdCIsImNoaWxkcmVuIiwiY2hpbGQiLCJWWEVUYWJsZVBsdWdpbkNoYXJ0cyIsImluc3RhbGwiLCJ4dGFibGUiLCJpbnRlcmNlcHRvciIsIm1lbnVzIiwiX21vZGFsIiwiRXJyb3IiLCJhZGQiLCJtaXhpbiIsIndpbmRvdyIsIlZYRVRhYmxlIiwidXNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTs7QUFFQTs7Ozs7Ozs7QUFFQSxTQUFTQSxnQkFBVCxDQUEyQkMsVUFBM0IsRUFBMEM7QUFDeEMsU0FBTyxVQUFxQkMsTUFBckIsRUFBZ0M7QUFBQSxRQUMvQkMsTUFEK0IsR0FDZEQsTUFEYyxDQUMvQkMsTUFEK0I7QUFBQSxRQUN2QkMsSUFEdUIsR0FDZEYsTUFEYyxDQUN2QkUsSUFEdUI7QUFFckMsUUFBSUMsV0FBVyxHQUFhRixNQUFNLENBQUNFLFdBQW5DOztBQUNBLFFBQUksQ0FBQ0EsV0FBTCxFQUFrQjtBQUNoQkEsTUFBQUEsV0FBVyxHQUFHRixNQUFNLENBQUNFLFdBQVAsR0FBcUIsRUFBbkM7QUFDRDs7QUFDRCxRQUFNQyxJQUFJLEdBQUc7QUFDWEMsTUFBQUEsRUFBRSxFQUFFQyxvQkFBUUMsUUFBUixFQURPO0FBRVhDLE1BQUFBLE1BQU0sRUFBRSxJQUZHO0FBR1hDLE1BQUFBLElBQUksRUFBRSxLQUhLO0FBSVhDLE1BQUFBLFFBQVEsRUFBRSxLQUpDO0FBS1hDLE1BQUFBLFVBQVUsRUFBRSxLQUxEO0FBTVhDLE1BQUFBLEtBQUssRUFBRSxHQU5JO0FBT1hDLE1BQUFBLE1BQU0sRUFBRSxHQVBHO0FBUVhDLE1BQUFBLEtBQUssRUFBRVosSUFBSSxDQUFDYSxJQVJEO0FBU1hDLE1BQUFBLEtBQUssRUFBRTtBQUFBLHFDQUNJaEIs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TyxJQUFNK0Ysb0JBQW9CLEdBQUc7QUFDbENDLEVBQUFBLE9BRGtDLG1CQUN6QkMsTUFEeUIsRUFDRjtBQUFBLFFBQ3hCQyxXQUR3QixHQUNPRCxNQURQLENBQ3hCQyxXQUR3QjtBQUFBLFFBQ1hDLEtBRFcsR0FDT0YsTUFEUCxDQUNYRSxLQURXO0FBQUEsUUFDSkMsTUFESSxHQUNPSCxNQURQLENBQ0pHLE1BREk7O0FBRTlCLFFBQUksQ0FBQ0EsTUFBTCxFQUFhO0FBQ1gsWUFBTSxJQUFJQyxLQUFKLENBQVUsaURBQVYsQ0FBTjtBQUNEOztBQUNESCxJQUFBQSxXQUFXLENBQUNJLEdBQVosQ0FBZ0IsZUFBaEIsRUFBaUNkLHdCQUFqQztBQUNBVSxJQUFBQSxXQUFXLENBQUNJLEdBQVosQ0FBZ0IsZ0JBQWhCLEVBQWtDWixvQkFBbEM7QUFDQVMsSUFBQUEsS0FBSyxDQUFDSSxLQUFOLENBQVlwRSxPQUFaO0FBQ0Q7QUFUaUMsQ0FBN0I7OztBQVlQLElBQUksT0FBT3FFLE1BQVAsS0FBa0IsV0FBbEIsSUFBaUNBLE1BQU0sQ0FBQ0MsUUFBNUMsRUFBc0Q7QUFDcERELEVBQUFBLE1BQU0sQ0FBQ0MsUUFBUCxDQUFnQkMsR0FBaEIsQ0FBb0JYLG9CQUFwQjtBQUNEOztnQkFFY0Esb0IiLCJmaWxlIjoiaW5kZXguY29tbW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFhFVXRpbHMgZnJvbSAneGUtdXRpbHMvbWV0aG9kcy94ZS11dGlscydcclxuaW1wb3J0IFZYRVRhYmxlIGZyb20gJ3Z4ZS10YWJsZS9saWIvdnhlLXRhYmxlJ1xyXG5pbXBvcnQgKiBhcyBlY2hhcnRzIGZyb20gJ2VjaGFydHMvbGliL2VjaGFydHMnXHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDaGFydE1vZGFsIChnZXRPcHRpb25zOiBhbnkpIHtcclxuICByZXR1cm4gZnVuY3Rpb24gKHRoaXM6IGFueSwgcGFyYW1zOiBhbnkpIHtcclxuICAgIGxldCB7ICR0YWJsZSwgbWVudSB9ID0gcGFyYW1zXHJcbiAgICBsZXQgY2hhcnRNb2RhbHM6IHN0cmluZ1tdID0gJHRhYmxlLmNoYXJ0TW9kYWxzXHJcbiAgICBpZiAoIWNoYXJ0TW9kYWxzKSB7XHJcbiAgICAgIGNoYXJ0TW9kYWxzID0gJHRhYmxlLmNoYXJ0TW9kYWxzID0gW11cclxuICAgIH1cclxuICAgIGNvbnN0IG9wdHMgPSB7XHJcbiAgICAgIGlkOiBYRVV0aWxzLnVuaXF1ZUlkKCksXHJcbiAgICAgIHJlc2l6ZTogdHJ1ZSxcclxuICAgICAgbWFzazogZmFsc2UsXHJcbiAgICAgIGxvY2tWaWV3OiBmYWxzZSxcclxuICAgICAgc2hvd0Zvb3RlcjogZmFsc2UsXHJcbiAgICAgIHdpZHRoOiA2MDAsXHJcbiAgICAgIGhlaWdodDogNDAwLFxyXG4gICAgICB0aXRsZTogbWVudS5uYW1lLFxyXG4gICAgICBzbG90czoge1xyXG4gICAgICAgIGRlZmF1bHQgKHBhcmFtczogYW55LCBoOiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgaCgnZGl2Jywge1xyXG4gICAgICAgICAgICAgIGNsYXNzOiAndnhlLWNoYXJ0LS13cmFwcGVyJ1xyXG4gICAgICAgICAgICB9LCBbXHJcbiAgICAgICAgICAgICAgaCgnZGl2Jywge1xyXG4gICAgICAgICAgICAgICAgY2xhc3M6ICd2eGUtY2hhcnQtLXBhbmVsJ1xyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIF0pXHJcbiAgICAgICAgICBdXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBldmVudHM6IHtcclxuICAgICAgICBzaG93ICh7ICRtb2RhbCB9OiBhbnkpIHtcclxuICAgICAgICAgIGNvbnN0ICRjaGFydCA9IGVjaGFydHMuaW5pdCgkbW9kYWwuJGVsLnF1ZXJ5U2VsZWN0b3IoJy52eGUtY2hhcnQtLXdyYXBwZXInKSlcclxuICAgICAgICAgICRjaGFydC5zZXRPcHRpb24oZ2V0T3B0aW9ucyhwYXJhbXMpKVxyXG4gICAgICAgICAgJG1vZGFsLiRjaGFydCA9ICRjaGFydFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2xvc2UgKHsgJG1vZGFsIH06IGFueSkge1xyXG4gICAgICAgICAgLy8g5pen54mI5pys77yM5Y2z5bCG5bqf5byDXHJcbiAgICAgICAgICBYRVV0aWxzLnJlbW92ZShjaGFydE1vZGFscywgaWQgPT4gaWQgPT09ICRtb2RhbC5pZClcclxuICAgICAgICAgICRtb2RhbC4kY2hhcnQuZGlzcG9zZSgpXHJcbiAgICAgICAgICAkbW9kYWwuJGNoYXJ0ID0gbnVsbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaGlkZSAoeyAkbW9kYWwgfTogYW55KSB7XHJcbiAgICAgICAgICBYRVV0aWxzLnJlbW92ZShjaGFydE1vZGFscywgaWQgPT4gaWQgPT09ICRtb2RhbC5pZClcclxuICAgICAgICAgICRtb2RhbC4kY2hhcnQuZGlzcG9zZSgpXHJcbiAgICAgICAgICAkbW9kYWwuJGNoYXJ0ID0gbnVsbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgem9vbSAoeyAkbW9kYWwgfTogYW55KSB7XHJcbiAgICAgICAgICAkbW9kYWwuJGNoYXJ0LnJlc2l6ZSgpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBjaGFydE1vZGFscy5wdXNoKG9wdHMuaWQpXHJcbiAgICBpZiAodGhpcy4kWE1vZGFsLm9wZW4pIHtcclxuICAgICAgdGhpcy4kWE1vZGFsLm9wZW4ob3B0cylcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIOaXp+eJiOacrO+8jOWNs+WwhuW6n+W8g1xyXG4gICAgICB0aGlzLiRYTW9kYWwob3B0cylcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmludGVyZmFjZSBsZWdlbmRPcHRzIHtcclxuICBkYXRhOiBBcnJheTxhbnk+O1xyXG59XHJcblxyXG5jb25zdCBtZW51TWFwID0ge1xyXG4gIENIQVJUX0JBUl9YX0FYSVM6IGNyZWF0ZUNoYXJ0TW9kYWwoKHBhcmFtczogYW55KSA9PiB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgbWVudSB9ID0gcGFyYW1zXHJcbiAgICBjb25zdCB7IHJvd3MsIGNvbHVtbnMgfSA9ICR0YWJsZS5nZXRTZWxlY3RlZFJhbmdlcyA/ICR0YWJsZS5nZXRTZWxlY3RlZFJhbmdlcygpIDogJHRhYmxlLmdldE1vdXNlQ2hlY2tlZHMoKVxyXG4gICAgY29uc3QgeyBwYXJhbXM6IGNoYXJ0UGFyYW1zID0ge30gfSA9IG1lbnVcclxuICAgIGNvbnN0IHsgY2F0ZWdvcnkgfSA9IGNoYXJ0UGFyYW1zXHJcbiAgICBsZXQgY2F0ZWdvcnlDb2x1bW4gPSAkdGFibGUuZ2V0Q29sdW1uQnlGaWVsZChjYXRlZ29yeSB8fCBjb2x1bW5zWzBdLnByb3BlcnR5KVxyXG4gICAgbGV0IHNlcmllQ29sdW1ucyA9IGNvbHVtbnMuZmlsdGVyKChjb2x1bW46IGFueSkgPT4gY29sdW1uLnByb3BlcnR5ICE9PSBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eSlcclxuICAgIGxldCBsZWdlbmRPcHRzOiBsZWdlbmRPcHRzID0ge1xyXG4gICAgICBkYXRhOiBbXVxyXG4gICAgfVxyXG4gICAgbGV0IHNlcmllc09wdHM6IEFycmF5PGFueT4gPSBbXVxyXG4gICAgbGV0IHhBeGlzT3B0cyA9IHtcclxuICAgICAgdHlwZTogJ2NhdGVnb3J5JyxcclxuICAgICAgZGF0YTogcm93cy5tYXAoKHJvdzogYW55KSA9PiBYRVV0aWxzLmdldChyb3csIGNhdGVnb3J5Q29sdW1uLnByb3BlcnR5KSlcclxuICAgIH1cclxuICAgIHNlcmllQ29sdW1ucy5mb3JFYWNoKChjb2x1bW46IGFueSkgPT4ge1xyXG4gICAgICBsZWdlbmRPcHRzLmRhdGEucHVzaChjb2x1bW4udGl0bGUpXHJcbiAgICAgIHNlcmllc09wdHMucHVzaCh7XHJcbiAgICAgICAgbmFtZTogY29sdW1uLnRpdGxlLFxyXG4gICAgICAgIHR5cGU6ICdiYXInLFxyXG4gICAgICAgIGRhdGE6IHJvd3MubWFwKChyb3c6IGFueSkgPT4gWEVVdGlscy5nZXQocm93LCBjb2x1bW4ucHJvcGVydHkpKVxyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICAgIGNvbnN0IG9wdGlvbiA9IHtcclxuICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgIHRyaWdnZXI6ICdheGlzJyxcclxuICAgICAgICBheGlzUG9pbnRlcjoge1xyXG4gICAgICAgICAgdHlwZTogJ3NoYWRvdydcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGxlZ2VuZDogbGVnZW5kT3B0cyxcclxuICAgICAgeEF4aXM6IHhBeGlzT3B0cyxcclxuICAgICAgeUF4aXM6IHtcclxuICAgICAgICB0eXBlOiAndmFsdWUnXHJcbiAgICAgIH0sXHJcbiAgICAgIHNlcmllczogc2VyaWVzT3B0c1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9wdGlvblxyXG4gIH0pLFxyXG4gIENIQVJUX0JBUl9ZX0FYSVM6IGNyZWF0ZUNoYXJ0TW9kYWwoKHBhcmFtczogYW55KSA9PiB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgbWVudSB9ID0gcGFyYW1zXHJcbiAgICBjb25zdCB7IHJvd3MsIGNvbHVtbnMgfSA9ICR0YWJsZS5nZXRTZWxlY3RlZFJhbmdlcyA/ICR0YWJsZS5nZXRTZWxlY3RlZFJhbmdlcygpIDogJHRhYmxlLmdldE1vdXNlQ2hlY2tlZHMoKVxyXG4gICAgY29uc3QgeyBwYXJhbXM6IGNoYXJ0UGFyYW1zID0ge30gfSA9IG1lbnVcclxuICAgIGNvbnN0IHsgY2F0ZWdvcnkgfSA9IGNoYXJ0UGFyYW1zXHJcbiAgICBsZXQgY2F0ZWdvcnlDb2x1bW4gPSAkdGFibGUuZ2V0Q29sdW1uQnlGaWVsZChjYXRlZ29yeSB8fCBjb2x1bW5zWzBdLnByb3BlcnR5KVxyXG4gICAgbGV0IHNlcmllQ29sdW1ucyA9IGNvbHVtbnMuZmlsdGVyKChjb2x1bW46IGFueSkgPT4gY29sdW1uLnByb3BlcnR5ICE9PSBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eSlcclxuICAgIGxldCBsZWdlbmRPcHRzOiBsZWdlbmRPcHRzID0ge1xyXG4gICAgICBkYXRhOiBbXVxyXG4gICAgfVxyXG4gICAgbGV0IHNlcmllc09wdHM6IEFycmF5PGFueT4gPSBbXVxyXG4gICAgbGV0IHhBeGlzT3B0cyA9IHtcclxuICAgICAgdHlwZTogJ2NhdGVnb3J5JyxcclxuICAgICAgZGF0YTogcm93cy5tYXAoKHJvdzogYW55KSA9PiBYRVV0aWxzLmdldChyb3csIGNhdGVnb3J5Q29sdW1uLnByb3BlcnR5KSlcclxuICAgIH1cclxuICAgIHNlcmllQ29sdW1ucy5mb3JFYWNoKChjb2x1bW46IGFueSkgPT4ge1xyXG4gICAgICBsZWdlbmRPcHRzLmRhdGEucHVzaChjb2x1bW4udGl0bGUpXHJcbiAgICAgIHNlcmllc09wdHMucHVzaCh7XHJcbiAgICAgICAgbmFtZTogY29sdW1uLnRpdGxlLFxyXG4gICAgICAgIHR5cGU6ICdiYXInLFxyXG4gICAgICAgIGRhdGE6IHJvd3MubWFwKChyb3c6IGFueSkgPT4gWEVVdGlscy5nZXQocm93LCBjb2x1bW4ucHJvcGVydHkpKVxyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICAgIGNvbnN0IG9wdGlvbiA9IHtcclxuICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgIHRyaWdnZXI6ICdheGlzJyxcclxuICAgICAgICBheGlzUG9pbnRlcjoge1xyXG4gICAgICAgICAgdHlwZTogJ3NoYWRvdydcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGxlZ2VuZDogbGVnZW5kT3B0cyxcclxuICAgICAgeEF4aXM6IHhBeGlzT3B0cyxcclxuICAgICAgeUF4aXM6IHtcclxuICAgICAgICB0eXBlOiAndmFsdWUnXHJcbiAgICAgIH0sXHJcbiAgICAgIHNlcmllczogc2VyaWVzT3B0c1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9wdGlvblxyXG4gIH0pLFxyXG4gIENIQVJUX0xJTkU6IGNyZWF0ZUNoYXJ0TW9kYWwoKHBhcmFtczogYW55KSA9PiB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgbWVudSB9ID0gcGFyYW1zXHJcbiAgICBjb25zdCB7IHJvd3MsIGNvbHVtbnMgfSA9ICR0YWJsZS5nZXRTZWxlY3RlZFJhbmdlcyA/ICR0YWJsZS5nZXRTZWxlY3RlZFJhbmdlcygpIDogJHRhYmxlLmdldE1vdXNlQ2hlY2tlZHMoKVxyXG4gICAgY29uc3QgeyBwYXJhbXM6IGNoYXJ0UGFyYW1zID0ge30gfSA9IG1lbnVcclxuICAgIGNvbnN0IHsgY2F0ZWdvcnkgfSA9IGNoYXJ0UGFyYW1zXHJcbiAgICBsZXQgY2F0ZWdvcnlDb2x1bW4gPSAkdGFibGUuZ2V0Q29sdW1uQnlGaWVsZChjYXRlZ29yeSB8fCBjb2x1bW5zWzBdLnByb3BlcnR5KVxyXG4gICAgbGV0IHNlcmllQ29sdW1ucyA9IGNvbHVtbnMuZmlsdGVyKChjb2x1bW46IGFueSkgPT4gY29sdW1uLnByb3BlcnR5ICE9PSBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eSlcclxuICAgIGxldCBsZWdlbmRPcHRzOiBsZWdlbmRPcHRzID0ge1xyXG4gICAgICBkYXRhOiBbXVxyXG4gICAgfVxyXG4gICAgbGV0IHNlcmllc09wdHM6IEFycmF5PGFueT4gPSBbXVxyXG4gICAgbGV0IHhBeGlzT3B0cyA9IHtcclxuICAgICAgdHlwZTogJ2NhdGVnb3J5JyxcclxuICAgICAgZGF0YTogcm93cy5tYXAoKHJvdzogYW55KSA9PiBYRVV0aWxzLmdldChyb3csIGNhdGVnb3J5Q29sdW1uLnByb3BlcnR5KSlcclxuICAgIH1cclxuICAgIHNlcmllQ29sdW1ucy5mb3JFYWNoKChjb2x1bW46IGFueSkgPT4ge1xyXG4gICAgICBsZWdlbmRPcHRzLmRhdGEucHVzaChjb2x1bW4udGl0bGUpXHJcbiAgICAgIHNlcmllc09wdHMucHVzaCh7XHJcbiAgICAgICAgbmFtZTogY29sdW1uLnRpdGxlLFxyXG4gICAgICAgIHR5cGU6ICdsaW5lJyxcclxuICAgICAgICBkYXRhOiByb3dzLm1hcCgocm93OiBhbnkpID0+IFhFVXRpbHMuZ2V0KHJvdywgY29sdW1uLnByb3BlcnR5KSlcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgICBsZXQgb3B0aW9uID0ge1xyXG4gICAgICB0b29sdGlwOiB7XHJcbiAgICAgICAgdHJpZ2dlcjogJ2F4aXMnXHJcbiAgICAgIH0sXHJcbiAgICAgIGxlZ2VuZDogbGVnZW5kT3B0cyxcclxuICAgICAgdG9vbGJveDoge1xyXG4gICAgICAgIGZlYXR1cmU6IHtcclxuICAgICAgICAgIHNhdmVBc0ltYWdlOiB7fVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgeEF4aXM6IHhBeGlzT3B0cyxcclxuICAgICAgeUF4aXM6IHtcclxuICAgICAgICB0eXBlOiAndmFsdWUnXHJcbiAgICAgIH0sXHJcbiAgICAgIHNlcmllczogc2VyaWVzT3B0c1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9wdGlvblxyXG4gIH0pLFxyXG4gIENIQVJUX1BJRTogY3JlYXRlQ2hhcnRNb2RhbCgocGFyYW1zOiBhbnkpID0+IHtcclxuICAgIGNvbnN0IHsgJHRhYmxlLCBtZW51IH0gPSBwYXJhbXNcclxuICAgIGNvbnN0IHsgcm93cywgY29sdW1ucyB9ID0gJHRhYmxlLmdldFNlbGVjdGVkUmFuZ2VzID8gJHRhYmxlLmdldFNlbGVjdGVkUmFuZ2VzKCkgOiAkdGFibGUuZ2V0TW91c2VDaGVja2VkcygpXHJcbiAgICBjb25zdCB7IHBhcmFtczogY2hhcnRQYXJhbXMgPSB7fSB9ID0gbWVudVxyXG4gICAgY29uc3QgeyBjYXRlZ29yeSB9ID0gY2hhcnRQYXJhbXNcclxuICAgIGxldCBjYXRlZ29yeUNvbHVtbiA9ICR0YWJsZS5nZXRDb2x1bW5CeUZpZWxkKGNhdGVnb3J5IHx8IGNvbHVtbnNbMF0ucHJvcGVydHkpXHJcbiAgICBsZXQgc2VyaWVDb2x1bW5zID0gY29sdW1ucy5maWx0ZXIoKGNvbHVtbjogYW55KSA9PiBjb2x1bW4ucHJvcGVydHkgIT09IGNhdGVnb3J5Q29sdW1uLnByb3BlcnR5KVxyXG4gICAgbGV0IHNlcmllQ29sdW1uID0gc2VyaWVDb2x1bW5zWzBdXHJcbiAgICBsZXQgbGVnZW5kRGF0YSA9IHJvd3MubWFwKChyb3c6IGFueSkgPT4gWEVVdGlscy5nZXQocm93LCBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eSkpXHJcbiAgICBsZXQgc2VyaWVzRGF0YTogQXJyYXk8YW55PiA9IFtdXHJcbiAgICByb3dzLmZvckVhY2goKHJvdzogYW55KSA9PiB7XHJcbiAgICAgIHNlcmllc0RhdGEucHVzaCh7XHJcbiAgICAgICAgbmFtZTogWEVVdGlscy5nZXQocm93LCBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eSksXHJcbiAgICAgICAgdmFsdWU6IFhFVXRpbHMuZ2V0KHJvdywgc2VyaWVDb2x1bW4ucHJvcGVydHkpXHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gICAgbGV0IG9wdGlvbiA9IHtcclxuICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgIHRyaWdnZXI6ICdpdGVtJyxcclxuICAgICAgICBmb3JtYXR0ZXI6ICd7YX0gPGJyLz57Yn0gOiB7Y30gKHtkfSUpJ1xyXG4gICAgICB9LFxyXG4gICAgICBsZWdlbmQ6IHtcclxuICAgICAgICB0eXBlOiAnc2Nyb2xsJyxcclxuICAgICAgICBvcmllbnQ6ICd2ZXJ0aWNhbCcsXHJcbiAgICAgICAgcmlnaHQ6IDEwLFxyXG4gICAgICAgIHRvcDogMjAsXHJcbiAgICAgICAgYm90dG9tOiAyMCxcclxuICAgICAgICBkYXRhOiBsZWdlbmREYXRhXHJcbiAgICAgICAgLy8gc2VsZWN0ZWQ6IGRhdGEuc2VsZWN0ZWRcclxuICAgICAgfSxcclxuICAgICAgc2VyaWVzOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgbmFtZTogc2VyaWVDb2x1bW4udGl0bGUsXHJcbiAgICAgICAgICB0eXBlOiAncGllJyxcclxuICAgICAgICAgIHJhZGl1czogJzUwJScsXHJcbiAgICAgICAgICBjZW50ZXI6IFsnNDAlJywgJzUwJSddLFxyXG4gICAgICAgICAgZGF0YTogc2VyaWVzRGF0YVxyXG4gICAgICAgIH1cclxuICAgICAgXVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9wdGlvblxyXG4gIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoZWNrUHJpdmlsZWdlIChpdGVtOiBhbnksIHBhcmFtczogYW55KSB7XHJcbiAgY29uc3QgeyAkdGFibGUgfSA9IHBhcmFtc1xyXG4gIGNvbnN0IHsgY29kZSwgcGFyYW1zOiBjaGFydFBhcmFtcyA9IHt9IH0gPSBpdGVtXHJcbiAgc3dpdGNoIChjb2RlKSB7XHJcbiAgICBjYXNlICdDSEFSVF9CQVJfWF9BWElTJzpcclxuICAgIGNhc2UgJ0NIQVJUX0JBUl9ZX0FYSVMnOlxyXG4gICAgY2FzZSAnQ0hBUlRfTElORSc6IHtcclxuICAgICAgY29uc3QgeyByb3dzLCBjb2x1bW5zIH0gPSAkdGFibGUuZ2V0U2VsZWN0ZWRSYW5nZXMgPyAkdGFibGUuZ2V0U2VsZWN0ZWRSYW5nZXMoKSA6ICR0YWJsZS5nZXRNb3VzZUNoZWNrZWRzKClcclxuICAgICAgY29uc3QgeyBjYXRlZ29yeSB9ID0gY2hhcnRQYXJhbXNcclxuICAgICAgaWYgKGNhdGVnb3J5KSB7XHJcbiAgICAgICAgbGV0IHNlcmllQ29sdW1ucyA9IGNvbHVtbnMuZmlsdGVyKChjb2x1bW46IGFueSkgPT4gY29sdW1uLnByb3BlcnR5ICE9PSBjYXRlZ29yeSlcclxuICAgICAgICBpdGVtLmRpc2FibGVkID0gIXJvd3MubGVuZ3RoIHx8IHNlcmllQ29sdW1ucy5sZW5ndGggPCAxXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaXRlbS5kaXNhYmxlZCA9ICFyb3dzLmxlbmd0aCB8fCBjb2x1bW5zLmxlbmd0aCA8IDJcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgICBicmVha1xyXG4gICAgY2FzZSAnQ0hBUlRfUElFJzoge1xyXG4gICAgICBjb25zdCB7IHJvd3MsIGNvbHVtbnMgfSA9ICR0YWJsZS5nZXRTZWxlY3RlZFJhbmdlcyA/ICR0YWJsZS5nZXRTZWxlY3RlZFJhbmdlcygpIDogJHRhYmxlLmdldE1vdXNlQ2hlY2tlZHMoKVxyXG4gICAgICBjb25zdCB7IGNhdGVnb3J5IH0gPSBjaGFydFBhcmFtc1xyXG4gICAgICBpZiAoY2F0ZWdvcnkpIHtcclxuICAgICAgICBsZXQgc2VyaWVDb2x1bW5zID0gY29sdW1ucy5maWx0ZXIoKGNvbHVtbjogYW55KSA9PiBjb2x1bW4ucHJvcGVydHkgIT09IGNhdGVnb3J5KVxyXG4gICAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhcm93cy5sZW5ndGggfHwgc2VyaWVDb2x1bW5zLmxlbmd0aCAhPT0gMVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhcm93cy5sZW5ndGggfHwgY29sdW1ucy5sZW5ndGggIT09IDJcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgICBicmVha1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQmVmb3JlRGVzdHJveUV2ZW50ICh7ICR0YWJsZSB9OiBhbnkpIHtcclxuICBsZXQgeyAkWE1vZGFsLCBjaGFydE1vZGFscyB9ID0gJHRhYmxlXHJcbiAgaWYgKGNoYXJ0TW9kYWxzKSB7XHJcbiAgICBpZiAoJFhNb2RhbC5jbG9zZSkge1xyXG4gICAgICBjaGFydE1vZGFscy5mb3JFYWNoKChpZDogc3RyaW5nKSA9PiAkWE1vZGFsLmNsb3NlKGlkKSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIOaXp+eJiOacrO+8jOWNs+WwhuW6n+W8g1xyXG4gICAgICAkWE1vZGFsLmNsb3NlQWxsKClcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByaXZpbGVnZUV2ZW50IChwYXJhbXM6IGFueSkge1xyXG4gIHBhcmFtcy5vcHRpb25zLmZvckVhY2goKGxpc3Q6IEFycmF5PGFueT4pID0+IHtcclxuICAgIGxpc3QuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB7XHJcbiAgICAgIGNoZWNrUHJpdmlsZWdlKGl0ZW0sIHBhcmFtcylcclxuICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4pIHtcclxuICAgICAgICBpdGVtLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkOiBhbnkpID0+IHtcclxuICAgICAgICAgIGNoZWNrUHJpdmlsZWdlKGNoaWxkLCBwYXJhbXMpXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICog5Z+65LqOIHZ4ZS10YWJsZSDooajmoLznmoTlm77ooajmuLLmn5Pmj5Lku7ZcclxuICovXHJcbmV4cG9ydCBjb25zdCBWWEVUYWJsZVBsdWdpbkNoYXJ0cyA9IHtcclxuICBpbnN0YWxsICh4dGFibGU6IHR5cGVvZiBWWEVUYWJsZSkge1xyXG4gICAgbGV0IHsgaW50ZXJjZXB0b3IsIG1lbnVzLCBfbW9kYWwgfSA9IHh0YWJsZVxyXG4gICAgaWYgKCFfbW9kYWwpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbdnhlLXRhYmxlLXBsdWdpbi1jaGFydHNdIHJlcXVpcmUgTW9kYWwgbW9kdWxlLicpXHJcbiAgICB9XHJcbiAgICBpbnRlcmNlcHRvci5hZGQoJ2JlZm9yZURlc3Ryb3knLCBoYW5kbGVCZWZvcmVEZXN0cm95RXZlbnQpXHJcbiAgICBpbnRlcmNlcHRvci5hZGQoJ2V2ZW50LnNob3dNZW51JywgaGFuZGxlUHJpdmlsZWdlRXZlbnQpXHJcbiAgICBtZW51cy5taXhpbihtZW51TWFwKVxyXG4gIH1cclxufVxyXG5cclxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5WWEVUYWJsZSkge1xyXG4gIHdpbmRvdy5WWEVUYWJsZS51c2UoVlhFVGFibGVQbHVnaW5DaGFydHMpXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFZYRVRhYmxlUGx1Z2luQ2hhcnRzXHJcbiJdfQ==

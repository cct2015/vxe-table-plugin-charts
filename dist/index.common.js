"use strict";

exports.__esModule = true;

var xe_utils_1 = require("xe-utils/methods/xe-utils");

var echarts_1 = require("echarts/lib/echarts");

function createChartModal(getOptions) {
  return function (params) {
    var menu = params.menu;
    this.$XModal({
      resize: true,
      mask: false,
      lockView: false,
      showFooter: false,
      width: 600,
      height: 400,
      title: menu.name,
      slots: {
        "default": function _default(params, h) {
          return [h('div', {
            "class": 'vxe-chart--wrapper'
          }, [h('div', {
            "class": 'vxe-chart--panel'
          })])];
        }
      },
      events: {
        show: function show() {
          var $chart = echarts_1["default"].init(this.$el.querySelector('.vxe-chart--wrapper'));
          $chart.setOption(getOptions(params));
          this.$chart = $chart;
        },
        close: function close() {
          // 旧版本，即将废弃
          this.$chart.dispose();
          this.$chart = null;
        },
        hide: function hide() {
          this.$chart.dispose();
          this.$chart = null;
        },
        zoom: function zoom() {
          this.$chart.resize();
        }
      }
    });
  };
}

var menuMap = {
  CHART_BAR_X_AXIS: createChartModal(function (params) {
    var $table = params.$table,
        menu = params.menu;

    var _a = $table.getMouseCheckeds(),
        rows = _a.rows,
        columns = _a.columns;

    var _b = menu.params,
        chartParams = _b === void 0 ? {} : _b;
    var category = chartParams.category;
    var categoryColumn = $table.getColumnByField(category || columns[0].property);
    var serieColumns = columns.filter(function (column) {
      return column.property !== categoryColumn.property;
    });
    var legendOpts = {
      data: []
    };
    var seriesOpts = [];
    var xAxisOpts = {
      type: 'category',
      data: rows.map(function (row) {
        return xe_utils_1["default"].get(row, categoryColumn.property);
      })
    };
    serieColumns.forEach(function (column) {
      legendOpts.data.push(column.title);
      seriesOpts.push({
        name: column.title,
        type: 'bar',
        data: rows.map(function (row) {
          return xe_utils_1["default"].get(row, column.property);
        })
      });
    });
    var option = {
      tooltip: {
        trigger: 'axis',
        axisPointer: {
          type: 'shadow'
        }
      },
      legend: legendOpts,
      xAxis: xAxisOpts,
      yAxis: {
        type: 'value'
      },
      series: seriesOpts
    };
    return option;
  }),
  CHART_BAR_Y_AXIS: createChartModal(function (params) {
    var $table = params.$table,
        menu = params.menu;

    var _a = $table.getMouseCheckeds(),
        rows = _a.rows,
        columns = _a.columns;

    var _b = menu.params,
        chartParams = _b === void 0 ? {} : _b;
    var category = chartParams.category;
    var categoryColumn = $table.getColumnByField(category || columns[0].property);
    var serieColumns = columns.filter(function (column) {
      return column.property !== categoryColumn.property;
    });
    var legendOpts = {
      data: []
    };
    var seriesOpts = [];
    var xAxisOpts = {
      type: 'category',
      data: rows.map(function (row) {
        return xe_utils_1["default"].get(row, categoryColumn.property);
      })
    };
    serieColumns.forEach(function (column) {
      legendOpts.data.push(column.title);
      seriesOpts.push({
        name: column.title,
        type: 'bar',
        data: rows.map(function (row) {
          return xe_utils_1["default"].get(row, column.property);
        })
      });
    });
    var option = {
      tooltip: {
        trigger: 'axis',
        axisPointer: {
          type: 'shadow'
        }
      },
      legend: legendOpts,
      xAxis: xAxisOpts,
      yAxis: {
        type: 'value'
      },
      series: seriesOpts
    };
    return option;
  }),
  CHART_LINE: createChartModal(function (params) {
    var $table = params.$table,
        menu = params.menu;

    var _a = $table.getMouseCheckeds(),
        rows = _a.rows,
        columns = _a.columns;

    var _b = menu.params,
        chartParams = _b === void 0 ? {} : _b;
    var category = chartParams.category;
    var categoryColumn = $table.getColumnByField(category || columns[0].property);
    var serieColumns = columns.filter(function (column) {
      return column.property !== categoryColumn.property;
    });
    var legendOpts = {
      data: []
    };
    var seriesOpts = [];
    var xAxisOpts = {
      type: 'category',
      data: rows.map(function (row) {
        return xe_utils_1["default"].get(row, categoryColumn.property);
      })
    };
    serieColumns.forEach(function (column) {
      legendOpts.data.push(column.title);
      seriesOpts.push({
        name: column.title,
        type: 'line',
        data: rows.map(function (row) {
          return xe_utils_1["default"].get(row, column.property);
        })
      });
    });
    var option = {
      tooltip: {
        trigger: 'axis'
      },
      legend: legendOpts,
      toolbox: {
        feature: {
          saveAsImage: {}
        }
      },
      xAxis: xAxisOpts,
      yAxis: {
        type: 'value'
      },
      series: seriesOpts
    };
    return option;
  }),
  CHART_PIE: createChartModal(function (params) {
    var $table = params.$table,
        menu = params.menu;

    var _a = $table.getMouseCheckeds(),
        rows = _a.rows,
        columns = _a.columns;

    var _b = menu.params,
        chartParams = _b === void 0 ? {} : _b;
    var category = chartParams.category;
    var categoryColumn = $table.getColumnByField(category || columns[0].property);
    var serieColumns = columns.filter(function (column) {
      return column.property !== categoryColumn.property;
    });
    var serieColumn = serieColumns[0];
    var legendData = rows.map(function (row) {
      return xe_utils_1["default"].get(row, categoryColumn.property);
    });
    var seriesData = [];
    rows.forEach(function (row) {
      seriesData.push({
        name: xe_utils_1["default"].get(row, categoryColumn.property),
        value: xe_utils_1["default"].get(row, serieColumn.property)
      });
    });
    var option = {
      tooltip: {
        trigger: 'item',
        formatter: '{a} <br/>{b} : {c} ({d}%)'
      },
      legend: {
        type: 'scroll',
        orient: 'vertical',
        right: 10,
        top: 20,
        bottom: 20,
        data: legendData // selected: data.selected

      },
      series: [{
        name: serieColumn.title,
        type: 'pie',
        radius: '50%',
        center: ['40%', '50%'],
        data: seriesData
      }]
    };
    return option;
  })
};

function checkPrivilege(item, params) {
  var $table = params.$table;
  var code = item.code,
      _a = item.params,
      chartParams = _a === void 0 ? {} : _a;

  switch (code) {
    case 'CHART_BAR_X_AXIS':
    case 'CHART_BAR_Y_AXIS':
    case 'CHART_LINE':
      {
        var _b = $table.getMouseCheckeds(),
            rows = _b.rows,
            columns = _b.columns;

        var category_1 = chartParams.category;

        if (category_1) {
          var serieColumns = columns.filter(function (column) {
            return column.property !== category_1;
          });
          item.disabled = !rows.length || serieColumns.length < 1;
        } else {
          item.disabled = !rows.length || columns.length < 2;
        }
      }
      break;

    case 'CHART_PIE':
      {
        var _c = $table.getMouseCheckeds(),
            rows = _c.rows,
            columns = _c.columns;

        var category_2 = chartParams.category;

        if (category_2) {
          var serieColumns = columns.filter(function (column) {
            return column.property !== category_2;
          });
          item.disabled = !rows.length || serieColumns.length !== 1;
        } else {
          item.disabled = !rows.length || columns.length !== 2;
        }
      }
      break;
  }
}

function handlePrivilegeEvent(params) {
  params.options.forEach(function (list) {
    list.forEach(function (item) {
      checkPrivilege(item, params);

      if (item.children) {
        item.children.forEach(function (child) {
          checkPrivilege(child, params);
        });
      }
    });
  });
}
/**
 * 基于 vxe-table 表格的图表渲染插件
 */


exports.VXETablePluginCharts = {
  install: function install(xtable) {
    var interceptor = xtable.interceptor,
        menus = xtable.menus,
        _modal = xtable._modal;

    if (!_modal) {
      throw new Error('[vxe-table-plugin-charts] require Modal module.');
    }

    interceptor.add('event.show_menu', handlePrivilegeEvent);
    menus.mixin(menuMap);
  }
};

if (typeof window !== 'undefined' && window.VXETable) {
  window.VXETable.use(exports.VXETablePluginCharts);
}

exports["default"] = exports.VXETablePluginCharts;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIiwiaW5kZXgudHMiXSwibmFtZXMiOlsiZXhwb3J0cyIsIl9fZXNNb2R1bGUiLCJ4ZV91dGlsc18xIiwicmVxdWlyZSIsImVjaGFydHNfMSIsImNyZWF0ZUNoYXJ0TW9kYWwiLCJnZXRPcHRpb25zIiwicGFyYW1zIiwibWVudSIsIiRYTW9kYWwiLCJyZXNpemUiLCJtYXNrIiwibG9ja1ZpZXciLCJzaG93Rm9vdGVyIiwid2lkdGgiLCJoZWlnaHQiLCJ0aXRsZSIsIm5hbWUiLCJzbG90cyIsImgiLCJldmVudHMiLCJzaG93IiwiJGNoYXJ0IiwiaW5pdCIsIiRlbCIsInF1ZXJ5U2VsZWN0b3IiLCJzZXRPcHRpb24iLCJjbG9zZSIsImRpc3Bvc2UiLCJoaWRlIiwiem9vbSIsIm1lbnVNYXAiLCJDSEFSVF9CQVJfWF9BWElTIiwiJHRhYmxlIiwiX2EiLCJnZXRNb3VzZUNoZWNrZWRzIiwicm93cyIsImNvbHVtbnMiLCJfYiIsImNoYXJ0UGFyYW1zIiwiY2F0ZWdvcnkiLCJjYXRlZ29yeUNvbHVtbiIsImdldENvbHVtbkJ5RmllbGQiLCJwcm9wZXJ0eSIsInNlcmllQ29sdW1ucyIsImZpbHRlciIsImNvbHVtbiIsImxlZ2VuZE9wdHMiLCJkYXRhIiwic2VyaWVzT3B0cyIsInhBeGlzT3B0cyIsInR5cGUiLCJtYXAiLCJyb3ciLCJnZXQiLCJmb3JFYWNoIiwicHVzaCIsIm9wdGlvbiIsInRvb2x0aXAiLCJ0cmlnZ2VyIiwiYXhpc1BvaW50ZXIiLCJsZWdlbmQiLCJ4QXhpcyIsInlBeGlzIiwic2VyaWVzIiwiQ0hBUlRfQkFSX1lfQVhJUyIsIkNIQVJUX0xJTkUiLCJ0b29sYm94IiwiZmVhdHVyZSIsInNhdmVBc0ltYWdlIiwiQ0hBUlRfUElFIiwic2VyaWVDb2x1bW4iLCJsZWdlbmREYXRhIiwic2VyaWVzRGF0YSIsInZhbHVlIiwiZm9ybWF0dGVyIiwib3JpZW50IiwicmlnaHQiLCJ0b3AiLCJib3R0b20iLCJyYWRpdXMiLCJjZW50ZXIiLCJjaGVja1ByaXZpbGVnZSIsIml0ZW0iLCJjb2RlIiwiY2F0ZWdvcnlfMSIsImRpc2FibGVkIiwibGVuZ3RoIiwiX2MiLCJjYXRlZ29yeV8yIiwiaGFuZGxlUHJpdmlsZWdlRXZlbnQiLCJvcHRpb25zIiwibGlzdCIsImNoaWxkcmVuIiwiY2hpbGQiLCJWWEVUYWJsZVBsdWdpbkNoYXJ0cyIsImluc3RhbGwiLCJ4dGFibGUiLCJpbnRlcmNlcHRvciIsIm1lbnVzIiwiX21vZGFsIiwiRXJyb3IiLCJhZGQiLCJtaXhpbiIsIndpbmRvdyIsIlZYRVRhYmxlIiwidXNlIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFDQUEsT0FBTyxDQUFDQyxVQUFSLEdBQXFCLElBQXJCOztBQ0RBLElBQUFDLFVBQUEsR0FBQUMsT0FBQSxDQUFBLDJCQUFBLENBQUE7O0FBQ0EsSUFBQUMsU0FBQSxHQUFBRCxPQUFBLENBQUEscUJBQUEsQ0FBQTs7QUFHQSxTQUFTRSxnQkFBVCxDQUEyQkMsVUFBM0IsRUFBMEM7QUFDeEMsU0FBTyxVQUFVQyxNQUFWLEVBQXFCO0FBQ3BCLFFBQUFDLElBQUEsR0FBQUQsTUFBQSxDQUFBQyxJQUFBO0FBQ04sU0FBS0MsT0FBTCxDQUFhO0FBQ1hDLE1BQUFBLE1BQU0sRUFBRSxJQURHO0FBRVhDLE1BQUFBLElBQUksRUFBRSxLQUZLO0FBR1hDLE1BQUFBLFFBQVEsRUFBRSxLQUhDO0FBSVhDLE1BQUFBLFVBQVUsRUFBRSxLQUpEO0FBS1hDLE1BQUFBLEtBQUssRUFBRSxHQUxJO0FBTVhDLE1BQUFBLE1BQU0sRUFBRSxHQU5HO0FBT1hDLE1BQUFBLEtBQUssRUFBRVIsSUFBSSxDQUFDUyxJQVBEO0FBUVhDLE1BQUFBLEtBQUssRUFBRTtBQUNMLG1CQUFBLGtCQUFTWCxNQUFULEVBQXNCWSxDQUF0QixFQUFpQztBQUMvQixpQkFBTyxDQUNMQSxDQUFDLENBQUMsS0FBRCxFQUFRO0FBQ1AscUJBQU87QUFEQSxXQUFSLEVBRUUsQ0FDREEsQ0FBQyxDQUFDLEtBQUQsRUFBUTtBQUNQLHFCQUFPO0FBREEsV0FBUixD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RCxHQVREO0FBVUQ7QUFFRDs7Ozs7QUFHYVAsT0FBQSxDQUFBK0Ysb0JBQUEsR0FBdUI7QUFDbENDLEVBQUFBLE9BQU8sRUFBUCxpQkFBU0MsTUFBVCxFQUFnQztBQUN4QixRQUFBQyxXQUFBLEdBQUFELE1BQUEsQ0FBQUMsV0FBQTtBQUFBLFFBQWFDLEtBQUEsR0FBQUYsTUFBQSxDQUFBRSxLQUFiO0FBQUEsUUFBb0JDLE1BQUEsR0FBQUgsTUFBQSxDQUFBRyxNQUFwQjs7QUFDTixRQUFJLENBQUNBLE1BQUwsRUFBYTtBQUNYLFlBQU0sSUFBSUMsS0FBSixDQUFVLGlEQUFWLENBQU47QUFDRDs7QUFDREgsSUFBQUEsV0FBVyxDQUFDSSxHQUFaLENBQWdCLGlCQUFoQixFQUFtQ1osb0JBQW5DO0FBQ0FTLElBQUFBLEtBQUssQ0FBQ0ksS0FBTixDQUFZeEUsT0FBWjtBQUNEO0FBUmlDLENBQXZCOztBQVdiLElBQUksT0FBT3lFLE1BQVAsS0FBa0IsV0FBbEIsSUFBaUNBLE1BQU0sQ0FBQ0MsUUFBNUMsRUFBc0Q7QUFDcERELEVBQUFBLE1BQU0sQ0FBQ0MsUUFBUCxDQUFnQkMsR0FBaEIsQ0FBb0IxRyxPQUFBLENBQUErRixvQkFBcEI7QUFDRDs7QUFFRC9GLE9BQUEsQ0FBQSxTQUFBLENBQUEsR0FBZUEsT0FBQSxDQUFBK0Ysb0JBQWYiLCJmaWxlIjoiaW5kZXguY29tbW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xudmFyIHhlX3V0aWxzXzEgPSByZXF1aXJlKFwieGUtdXRpbHMvbWV0aG9kcy94ZS11dGlsc1wiKTtcbnZhciBlY2hhcnRzXzEgPSByZXF1aXJlKFwiZWNoYXJ0cy9saWIvZWNoYXJ0c1wiKTtcbmZ1bmN0aW9uIGNyZWF0ZUNoYXJ0TW9kYWwoZ2V0T3B0aW9ucykge1xuICAgIHJldHVybiBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciBtZW51ID0gcGFyYW1zLm1lbnU7XG4gICAgICAgIHRoaXMuJFhNb2RhbCh7XG4gICAgICAgICAgICByZXNpemU6IHRydWUsXG4gICAgICAgICAgICBtYXNrOiBmYWxzZSxcbiAgICAgICAgICAgIGxvY2tWaWV3OiBmYWxzZSxcbiAgICAgICAgICAgIHNob3dGb290ZXI6IGZhbHNlLFxuICAgICAgICAgICAgd2lkdGg6IDYwMCxcbiAgICAgICAgICAgIGhlaWdodDogNDAwLFxuICAgICAgICAgICAgdGl0bGU6IG1lbnUubmFtZSxcbiAgICAgICAgICAgIHNsb3RzOiB7XG4gICAgICAgICAgICAgICAgXCJkZWZhdWx0XCI6IGZ1bmN0aW9uIChwYXJhbXMsIGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIGgoJ2RpdicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNsYXNzXCI6ICd2eGUtY2hhcnQtLXdyYXBwZXInXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaCgnZGl2Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNsYXNzXCI6ICd2eGUtY2hhcnQtLXBhbmVsJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICBdKVxuICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBldmVudHM6IHtcbiAgICAgICAgICAgICAgICBzaG93OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkY2hhcnQgPSBlY2hhcnRzXzFbXCJkZWZhdWx0XCJdLmluaXQodGhpcy4kZWwucXVlcnlTZWxlY3RvcignLnZ4ZS1jaGFydC0td3JhcHBlcicpKTtcbiAgICAgICAgICAgICAgICAgICAgJGNoYXJ0LnNldE9wdGlvbihnZXRPcHRpb25zKHBhcmFtcykpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiRjaGFydCA9ICRjaGFydDtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNsb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIOaXp+eJiOacrO+8jOWNs+WwhuW6n+W8g1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiRjaGFydC5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJGNoYXJ0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGhpZGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kY2hhcnQuZGlzcG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiRjaGFydCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB6b29tOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJGNoYXJ0LnJlc2l6ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbnZhciBtZW51TWFwID0ge1xuICAgIENIQVJUX0JBUl9YX0FYSVM6IGNyZWF0ZUNoYXJ0TW9kYWwoZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgJHRhYmxlID0gcGFyYW1zLiR0YWJsZSwgbWVudSA9IHBhcmFtcy5tZW51O1xuICAgICAgICB2YXIgX2EgPSAkdGFibGUuZ2V0TW91c2VDaGVja2VkcygpLCByb3dzID0gX2Eucm93cywgY29sdW1ucyA9IF9hLmNvbHVtbnM7XG4gICAgICAgIHZhciBfYiA9IG1lbnUucGFyYW1zLCBjaGFydFBhcmFtcyA9IF9iID09PSB2b2lkIDAgPyB7fSA6IF9iO1xuICAgICAgICB2YXIgY2F0ZWdvcnkgPSBjaGFydFBhcmFtcy5jYXRlZ29yeTtcbiAgICAgICAgdmFyIGNhdGVnb3J5Q29sdW1uID0gJHRhYmxlLmdldENvbHVtbkJ5RmllbGQoY2F0ZWdvcnkgfHwgY29sdW1uc1swXS5wcm9wZXJ0eSk7XG4gICAgICAgIHZhciBzZXJpZUNvbHVtbnMgPSBjb2x1bW5zLmZpbHRlcihmdW5jdGlvbiAoY29sdW1uKSB7IHJldHVybiBjb2x1bW4ucHJvcGVydHkgIT09IGNhdGVnb3J5Q29sdW1uLnByb3BlcnR5OyB9KTtcbiAgICAgICAgdmFyIGxlZ2VuZE9wdHMgPSB7XG4gICAgICAgICAgICBkYXRhOiBbXVxuICAgICAgICB9O1xuICAgICAgICB2YXIgc2VyaWVzT3B0cyA9IFtdO1xuICAgICAgICB2YXIgeEF4aXNPcHRzID0ge1xuICAgICAgICAgICAgdHlwZTogJ2NhdGVnb3J5JyxcbiAgICAgICAgICAgIGRhdGE6IHJvd3MubWFwKGZ1bmN0aW9uIChyb3cpIHsgcmV0dXJuIHhlX3V0aWxzXzFbXCJkZWZhdWx0XCJdLmdldChyb3csIGNhdGVnb3J5Q29sdW1uLnByb3BlcnR5KTsgfSlcbiAgICAgICAgfTtcbiAgICAgICAgc2VyaWVDb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuICAgICAgICAgICAgbGVnZW5kT3B0cy5kYXRhLnB1c2goY29sdW1uLnRpdGxlKTtcbiAgICAgICAgICAgIHNlcmllc09wdHMucHVzaCh7XG4gICAgICAgICAgICAgICAgbmFtZTogY29sdW1uLnRpdGxlLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdiYXInLFxuICAgICAgICAgICAgICAgIGRhdGE6IHJvd3MubWFwKGZ1bmN0aW9uIChyb3cpIHsgcmV0dXJuIHhlX3V0aWxzXzFbXCJkZWZhdWx0XCJdLmdldChyb3csIGNvbHVtbi5wcm9wZXJ0eSk7IH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBvcHRpb24gPSB7XG4gICAgICAgICAgICB0b29sdGlwOiB7XG4gICAgICAgICAgICAgICAgdHJpZ2dlcjogJ2F4aXMnLFxuICAgICAgICAgICAgICAgIGF4aXNQb2ludGVyOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzaGFkb3cnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxlZ2VuZDogbGVnZW5kT3B0cyxcbiAgICAgICAgICAgIHhBeGlzOiB4QXhpc09wdHMsXG4gICAgICAgICAgICB5QXhpczoge1xuICAgICAgICAgICAgICAgIHR5cGU6ICd2YWx1ZSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXJpZXM6IHNlcmllc09wdHNcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIG9wdGlvbjtcbiAgICB9KSxcbiAgICBDSEFSVF9CQVJfWV9BWElTOiBjcmVhdGVDaGFydE1vZGFsKGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdmFyICR0YWJsZSA9IHBhcmFtcy4kdGFibGUsIG1lbnUgPSBwYXJhbXMubWVudTtcbiAgICAgICAgdmFyIF9hID0gJHRhYmxlLmdldE1vdXNlQ2hlY2tlZHMoKSwgcm93cyA9IF9hLnJvd3MsIGNvbHVtbnMgPSBfYS5jb2x1bW5zO1xuICAgICAgICB2YXIgX2IgPSBtZW51LnBhcmFtcywgY2hhcnRQYXJhbXMgPSBfYiA9PT0gdm9pZCAwID8ge30gOiBfYjtcbiAgICAgICAgdmFyIGNhdGVnb3J5ID0gY2hhcnRQYXJhbXMuY2F0ZWdvcnk7XG4gICAgICAgIHZhciBjYXRlZ29yeUNvbHVtbiA9ICR0YWJsZS5nZXRDb2x1bW5CeUZpZWxkKGNhdGVnb3J5IHx8IGNvbHVtbnNbMF0ucHJvcGVydHkpO1xuICAgICAgICB2YXIgc2VyaWVDb2x1bW5zID0gY29sdW1ucy5maWx0ZXIoZnVuY3Rpb24gKGNvbHVtbikgeyByZXR1cm4gY29sdW1uLnByb3BlcnR5ICE9PSBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eTsgfSk7XG4gICAgICAgIHZhciBsZWdlbmRPcHRzID0ge1xuICAgICAgICAgICAgZGF0YTogW11cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHNlcmllc09wdHMgPSBbXTtcbiAgICAgICAgdmFyIHhBeGlzT3B0cyA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdjYXRlZ29yeScsXG4gICAgICAgICAgICBkYXRhOiByb3dzLm1hcChmdW5jdGlvbiAocm93KSB7IHJldHVybiB4ZV91dGlsc18xW1wiZGVmYXVsdFwiXS5nZXQocm93LCBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eSk7IH0pXG4gICAgICAgIH07XG4gICAgICAgIHNlcmllQ29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChjb2x1bW4pIHtcbiAgICAgICAgICAgIGxlZ2VuZE9wdHMuZGF0YS5wdXNoKGNvbHVtbi50aXRsZSk7XG4gICAgICAgICAgICBzZXJpZXNPcHRzLnB1c2goe1xuICAgICAgICAgICAgICAgIG5hbWU6IGNvbHVtbi50aXRsZSxcbiAgICAgICAgICAgICAgICB0eXBlOiAnYmFyJyxcbiAgICAgICAgICAgICAgICBkYXRhOiByb3dzLm1hcChmdW5jdGlvbiAocm93KSB7IHJldHVybiB4ZV91dGlsc18xW1wiZGVmYXVsdFwiXS5nZXQocm93LCBjb2x1bW4ucHJvcGVydHkpOyB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgb3B0aW9uID0ge1xuICAgICAgICAgICAgdG9vbHRpcDoge1xuICAgICAgICAgICAgICAgIHRyaWdnZXI6ICdheGlzJyxcbiAgICAgICAgICAgICAgICBheGlzUG9pbnRlcjoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2hhZG93J1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsZWdlbmQ6IGxlZ2VuZE9wdHMsXG4gICAgICAgICAgICB4QXhpczogeEF4aXNPcHRzLFxuICAgICAgICAgICAgeUF4aXM6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndmFsdWUnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VyaWVzOiBzZXJpZXNPcHRzXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBvcHRpb247XG4gICAgfSksXG4gICAgQ0hBUlRfTElORTogY3JlYXRlQ2hhcnRNb2RhbChmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHZhciAkdGFibGUgPSBwYXJhbXMuJHRhYmxlLCBtZW51ID0gcGFyYW1zLm1lbnU7XG4gICAgICAgIHZhciBfYSA9ICR0YWJsZS5nZXRNb3VzZUNoZWNrZWRzKCksIHJvd3MgPSBfYS5yb3dzLCBjb2x1bW5zID0gX2EuY29sdW1ucztcbiAgICAgICAgdmFyIF9iID0gbWVudS5wYXJhbXMsIGNoYXJ0UGFyYW1zID0gX2IgPT09IHZvaWQgMCA/IHt9IDogX2I7XG4gICAgICAgIHZhciBjYXRlZ29yeSA9IGNoYXJ0UGFyYW1zLmNhdGVnb3J5O1xuICAgICAgICB2YXIgY2F0ZWdvcnlDb2x1bW4gPSAkdGFibGUuZ2V0Q29sdW1uQnlGaWVsZChjYXRlZ29yeSB8fCBjb2x1bW5zWzBdLnByb3BlcnR5KTtcbiAgICAgICAgdmFyIHNlcmllQ29sdW1ucyA9IGNvbHVtbnMuZmlsdGVyKGZ1bmN0aW9uIChjb2x1bW4pIHsgcmV0dXJuIGNvbHVtbi5wcm9wZXJ0eSAhPT0gY2F0ZWdvcnlDb2x1bW4ucHJvcGVydHk7IH0pO1xuICAgICAgICB2YXIgbGVnZW5kT3B0cyA9IHtcbiAgICAgICAgICAgIGRhdGE6IFtdXG4gICAgICAgIH07XG4gICAgICAgIHZhciBzZXJpZXNPcHRzID0gW107XG4gICAgICAgIHZhciB4QXhpc09wdHMgPSB7XG4gICAgICAgICAgICB0eXBlOiAnY2F0ZWdvcnknLFxuICAgICAgICAgICAgZGF0YTogcm93cy5tYXAoZnVuY3Rpb24gKHJvdykgeyByZXR1cm4geGVfdXRpbHNfMVtcImRlZmF1bHRcIl0uZ2V0KHJvdywgY2F0ZWdvcnlDb2x1bW4ucHJvcGVydHkpOyB9KVxuICAgICAgICB9O1xuICAgICAgICBzZXJpZUNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG4gICAgICAgICAgICBsZWdlbmRPcHRzLmRhdGEucHVzaChjb2x1bW4udGl0bGUpO1xuICAgICAgICAgICAgc2VyaWVzT3B0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICBuYW1lOiBjb2x1bW4udGl0bGUsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2xpbmUnLFxuICAgICAgICAgICAgICAgIGRhdGE6IHJvd3MubWFwKGZ1bmN0aW9uIChyb3cpIHsgcmV0dXJuIHhlX3V0aWxzXzFbXCJkZWZhdWx0XCJdLmdldChyb3csIGNvbHVtbi5wcm9wZXJ0eSk7IH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBvcHRpb24gPSB7XG4gICAgICAgICAgICB0b29sdGlwOiB7XG4gICAgICAgICAgICAgICAgdHJpZ2dlcjogJ2F4aXMnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGVnZW5kOiBsZWdlbmRPcHRzLFxuICAgICAgICAgICAgdG9vbGJveDoge1xuICAgICAgICAgICAgICAgIGZlYXR1cmU6IHtcbiAgICAgICAgICAgICAgICAgICAgc2F2ZUFzSW1hZ2U6IHt9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHhBeGlzOiB4QXhpc09wdHMsXG4gICAgICAgICAgICB5QXhpczoge1xuICAgICAgICAgICAgICAgIHR5cGU6ICd2YWx1ZSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXJpZXM6IHNlcmllc09wdHNcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIG9wdGlvbjtcbiAgICB9KSxcbiAgICBDSEFSVF9QSUU6IGNyZWF0ZUNoYXJ0TW9kYWwoZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgJHRhYmxlID0gcGFyYW1zLiR0YWJsZSwgbWVudSA9IHBhcmFtcy5tZW51O1xuICAgICAgICB2YXIgX2EgPSAkdGFibGUuZ2V0TW91c2VDaGVja2VkcygpLCByb3dzID0gX2Eucm93cywgY29sdW1ucyA9IF9hLmNvbHVtbnM7XG4gICAgICAgIHZhciBfYiA9IG1lbnUucGFyYW1zLCBjaGFydFBhcmFtcyA9IF9iID09PSB2b2lkIDAgPyB7fSA6IF9iO1xuICAgICAgICB2YXIgY2F0ZWdvcnkgPSBjaGFydFBhcmFtcy5jYXRlZ29yeTtcbiAgICAgICAgdmFyIGNhdGVnb3J5Q29sdW1uID0gJHRhYmxlLmdldENvbHVtbkJ5RmllbGQoY2F0ZWdvcnkgfHwgY29sdW1uc1swXS5wcm9wZXJ0eSk7XG4gICAgICAgIHZhciBzZXJpZUNvbHVtbnMgPSBjb2x1bW5zLmZpbHRlcihmdW5jdGlvbiAoY29sdW1uKSB7IHJldHVybiBjb2x1bW4ucHJvcGVydHkgIT09IGNhdGVnb3J5Q29sdW1uLnByb3BlcnR5OyB9KTtcbiAgICAgICAgdmFyIHNlcmllQ29sdW1uID0gc2VyaWVDb2x1bW5zWzBdO1xuICAgICAgICB2YXIgbGVnZW5kRGF0YSA9IHJvd3MubWFwKGZ1bmN0aW9uIChyb3cpIHsgcmV0dXJuIHhlX3V0aWxzXzFbXCJkZWZhdWx0XCJdLmdldChyb3csIGNhdGVnb3J5Q29sdW1uLnByb3BlcnR5KTsgfSk7XG4gICAgICAgIHZhciBzZXJpZXNEYXRhID0gW107XG4gICAgICAgIHJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG4gICAgICAgICAgICBzZXJpZXNEYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgIG5hbWU6IHhlX3V0aWxzXzFbXCJkZWZhdWx0XCJdLmdldChyb3csIGNhdGVnb3J5Q29sdW1uLnByb3BlcnR5KSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogeGVfdXRpbHNfMVtcImRlZmF1bHRcIl0uZ2V0KHJvdywgc2VyaWVDb2x1bW4ucHJvcGVydHkpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBvcHRpb24gPSB7XG4gICAgICAgICAgICB0b29sdGlwOiB7XG4gICAgICAgICAgICAgICAgdHJpZ2dlcjogJ2l0ZW0nLFxuICAgICAgICAgICAgICAgIGZvcm1hdHRlcjogJ3thfSA8YnIvPntifSA6IHtjfSAoe2R9JSknXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGVnZW5kOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3Njcm9sbCcsXG4gICAgICAgICAgICAgICAgb3JpZW50OiAndmVydGljYWwnLFxuICAgICAgICAgICAgICAgIHJpZ2h0OiAxMCxcbiAgICAgICAgICAgICAgICB0b3A6IDIwLFxuICAgICAgICAgICAgICAgIGJvdHRvbTogMjAsXG4gICAgICAgICAgICAgICAgZGF0YTogbGVnZW5kRGF0YVxuICAgICAgICAgICAgICAgIC8vIHNlbGVjdGVkOiBkYXRhLnNlbGVjdGVkXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VyaWVzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBzZXJpZUNvbHVtbi50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3BpZScsXG4gICAgICAgICAgICAgICAgICAgIHJhZGl1czogJzUwJScsXG4gICAgICAgICAgICAgICAgICAgIGNlbnRlcjogWyc0MCUnLCAnNTAlJ10sXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHNlcmllc0RhdGFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBvcHRpb247XG4gICAgfSlcbn07XG5mdW5jdGlvbiBjaGVja1ByaXZpbGVnZShpdGVtLCBwYXJhbXMpIHtcbiAgICB2YXIgJHRhYmxlID0gcGFyYW1zLiR0YWJsZTtcbiAgICB2YXIgY29kZSA9IGl0ZW0uY29kZSwgX2EgPSBpdGVtLnBhcmFtcywgY2hhcnRQYXJhbXMgPSBfYSA9PT0gdm9pZCAwID8ge30gOiBfYTtcbiAgICBzd2l0Y2ggKGNvZGUpIHtcbiAgICAgICAgY2FzZSAnQ0hBUlRfQkFSX1hfQVhJUyc6XG4gICAgICAgIGNhc2UgJ0NIQVJUX0JBUl9ZX0FYSVMnOlxuICAgICAgICBjYXNlICdDSEFSVF9MSU5FJzpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgX2IgPSAkdGFibGUuZ2V0TW91c2VDaGVja2VkcygpLCByb3dzID0gX2Iucm93cywgY29sdW1ucyA9IF9iLmNvbHVtbnM7XG4gICAgICAgICAgICAgICAgdmFyIGNhdGVnb3J5XzEgPSBjaGFydFBhcmFtcy5jYXRlZ29yeTtcbiAgICAgICAgICAgICAgICBpZiAoY2F0ZWdvcnlfMSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VyaWVDb2x1bW5zID0gY29sdW1ucy5maWx0ZXIoZnVuY3Rpb24gKGNvbHVtbikgeyByZXR1cm4gY29sdW1uLnByb3BlcnR5ICE9PSBjYXRlZ29yeV8xOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5kaXNhYmxlZCA9ICFyb3dzLmxlbmd0aCB8fCBzZXJpZUNvbHVtbnMubGVuZ3RoIDwgMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhcm93cy5sZW5ndGggfHwgY29sdW1ucy5sZW5ndGggPCAyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdDSEFSVF9QSUUnOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhciBfYyA9ICR0YWJsZS5nZXRNb3VzZUNoZWNrZWRzKCksIHJvd3MgPSBfYy5yb3dzLCBjb2x1bW5zID0gX2MuY29sdW1ucztcbiAgICAgICAgICAgICAgICB2YXIgY2F0ZWdvcnlfMiA9IGNoYXJ0UGFyYW1zLmNhdGVnb3J5O1xuICAgICAgICAgICAgICAgIGlmIChjYXRlZ29yeV8yKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXJpZUNvbHVtbnMgPSBjb2x1bW5zLmZpbHRlcihmdW5jdGlvbiAoY29sdW1uKSB7IHJldHVybiBjb2x1bW4ucHJvcGVydHkgIT09IGNhdGVnb3J5XzI7IH0pO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmRpc2FibGVkID0gIXJvd3MubGVuZ3RoIHx8IHNlcmllQ29sdW1ucy5sZW5ndGggIT09IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmRpc2FibGVkID0gIXJvd3MubGVuZ3RoIHx8IGNvbHVtbnMubGVuZ3RoICE9PSAyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGhhbmRsZVByaXZpbGVnZUV2ZW50KHBhcmFtcykge1xuICAgIHBhcmFtcy5vcHRpb25zLmZvckVhY2goZnVuY3Rpb24gKGxpc3QpIHtcbiAgICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICBjaGVja1ByaXZpbGVnZShpdGVtLCBwYXJhbXMpO1xuICAgICAgICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICBpdGVtLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrUHJpdmlsZWdlKGNoaWxkLCBwYXJhbXMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbi8qKlxuICog5Z+65LqOIHZ4ZS10YWJsZSDooajmoLznmoTlm77ooajmuLLmn5Pmj5Lku7ZcbiAqL1xuZXhwb3J0cy5WWEVUYWJsZVBsdWdpbkNoYXJ0cyA9IHtcbiAgICBpbnN0YWxsOiBmdW5jdGlvbiAoeHRhYmxlKSB7XG4gICAgICAgIHZhciBpbnRlcmNlcHRvciA9IHh0YWJsZS5pbnRlcmNlcHRvciwgbWVudXMgPSB4dGFibGUubWVudXMsIF9tb2RhbCA9IHh0YWJsZS5fbW9kYWw7XG4gICAgICAgIGlmICghX21vZGFsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1t2eGUtdGFibGUtcGx1Z2luLWNoYXJ0c10gcmVxdWlyZSBNb2RhbCBtb2R1bGUuJyk7XG4gICAgICAgIH1cbiAgICAgICAgaW50ZXJjZXB0b3IuYWRkKCdldmVudC5zaG93X21lbnUnLCBoYW5kbGVQcml2aWxlZ2VFdmVudCk7XG4gICAgICAgIG1lbnVzLm1peGluKG1lbnVNYXApO1xuICAgIH1cbn07XG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LlZYRVRhYmxlKSB7XG4gICAgd2luZG93LlZYRVRhYmxlLnVzZShleHBvcnRzLlZYRVRhYmxlUGx1Z2luQ2hhcnRzKTtcbn1cbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gZXhwb3J0cy5WWEVUYWJsZVBsdWdpbkNoYXJ0cztcbiIsImltcG9ydCBYRVV0aWxzIGZyb20gJ3hlLXV0aWxzL21ldGhvZHMveGUtdXRpbHMnXHJcbmltcG9ydCBlY2hhcnRzIGZyb20gJ2VjaGFydHMvbGliL2VjaGFydHMnXHJcbmltcG9ydCB7IFZYRVRhYmxlIH0gZnJvbSAndnhlLXRhYmxlJ1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2hhcnRNb2RhbCAoZ2V0T3B0aW9uczogYW55KSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uIChwYXJhbXM6IGFueSkge1xyXG4gICAgbGV0IHsgbWVudSB9ID0gcGFyYW1zXHJcbiAgICB0aGlzLiRYTW9kYWwoe1xyXG4gICAgICByZXNpemU6IHRydWUsXHJcbiAgICAgIG1hc2s6IGZhbHNlLFxyXG4gICAgICBsb2NrVmlldzogZmFsc2UsXHJcbiAgICAgIHNob3dGb290ZXI6IGZhbHNlLFxyXG4gICAgICB3aWR0aDogNjAwLFxyXG4gICAgICBoZWlnaHQ6IDQwMCxcclxuICAgICAgdGl0bGU6IG1lbnUubmFtZSxcclxuICAgICAgc2xvdHM6IHtcclxuICAgICAgICBkZWZhdWx0IChwYXJhbXM6IGFueSwgaDogRnVuY3Rpb24pIHtcclxuICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIGgoJ2RpdicsIHtcclxuICAgICAgICAgICAgICBjbGFzczogJ3Z4ZS1jaGFydC0td3JhcHBlcidcclxuICAgICAgICAgICAgfSwgW1xyXG4gICAgICAgICAgICAgIGgoJ2RpdicsIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzOiAndnhlLWNoYXJ0LS1wYW5lbCdcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICBdKVxyXG4gICAgICAgICAgXVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgc2hvdyAoKSB7XHJcbiAgICAgICAgICBjb25zdCAkY2hhcnQgPSBlY2hhcnRzLmluaXQodGhpcy4kZWwucXVlcnlTZWxlY3RvcignLnZ4ZS1jaGFydC0td3JhcHBlcicpKVxyXG4gICAgICAgICAgJGNoYXJ0LnNldE9wdGlvbihnZXRPcHRpb25zKHBhcmFtcykpXHJcbiAgICAgICAgICB0aGlzLiRjaGFydCA9ICRjaGFydFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2xvc2UgKCkge1xyXG4gICAgICAgICAgLy8g5pen54mI5pys77yM5Y2z5bCG5bqf5byDXHJcbiAgICAgICAgICB0aGlzLiRjaGFydC5kaXNwb3NlKClcclxuICAgICAgICAgIHRoaXMuJGNoYXJ0ID0gbnVsbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaGlkZSAoKSB7XHJcbiAgICAgICAgICB0aGlzLiRjaGFydC5kaXNwb3NlKClcclxuICAgICAgICAgIHRoaXMuJGNoYXJ0ID0gbnVsbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgem9vbSAoKSB7XHJcbiAgICAgICAgICB0aGlzLiRjaGFydC5yZXNpemUoKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcbn1cclxuXHJcbmludGVyZmFjZSBsZWdlbmRPcHRzIHtcclxuICBkYXRhOiBBcnJheTxhbnk+O1xyXG59XHJcblxyXG5jb25zdCBtZW51TWFwID0ge1xyXG4gIENIQVJUX0JBUl9YX0FYSVM6IGNyZWF0ZUNoYXJ0TW9kYWwoKHBhcmFtczogYW55KSA9PiB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgbWVudSB9ID0gcGFyYW1zXHJcbiAgICBjb25zdCB7IHJvd3MsIGNvbHVtbnMgfSA9ICR0YWJsZS5nZXRNb3VzZUNoZWNrZWRzKClcclxuICAgIGNvbnN0IHsgcGFyYW1zOiBjaGFydFBhcmFtcyA9IHt9IH0gPSBtZW51XHJcbiAgICBjb25zdCB7IGNhdGVnb3J5IH0gPSBjaGFydFBhcmFtc1xyXG4gICAgbGV0IGNhdGVnb3J5Q29sdW1uID0gJHRhYmxlLmdldENvbHVtbkJ5RmllbGQoY2F0ZWdvcnkgfHwgY29sdW1uc1swXS5wcm9wZXJ0eSlcclxuICAgIGxldCBzZXJpZUNvbHVtbnMgPSBjb2x1bW5zLmZpbHRlcigoY29sdW1uOiBhbnkpID0+IGNvbHVtbi5wcm9wZXJ0eSAhPT0gY2F0ZWdvcnlDb2x1bW4ucHJvcGVydHkpXHJcbiAgICBsZXQgbGVnZW5kT3B0czogbGVnZW5kT3B0cyA9IHtcclxuICAgICAgZGF0YTogW11cclxuICAgIH1cclxuICAgIGxldCBzZXJpZXNPcHRzOiBBcnJheTxhbnk+ID0gW11cclxuICAgIGxldCB4QXhpc09wdHMgPSB7XHJcbiAgICAgIHR5cGU6ICdjYXRlZ29yeScsXHJcbiAgICAgIGRhdGE6IHJvd3MubWFwKChyb3c6IGFueSkgPT4gWEVVdGlscy5nZXQocm93LCBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eSkpXHJcbiAgICB9XHJcbiAgICBzZXJpZUNvbHVtbnMuZm9yRWFjaCgoY29sdW1uOiBhbnkpID0+IHtcclxuICAgICAgbGVnZW5kT3B0cy5kYXRhLnB1c2goY29sdW1uLnRpdGxlKVxyXG4gICAgICBzZXJpZXNPcHRzLnB1c2goe1xyXG4gICAgICAgIG5hbWU6IGNvbHVtbi50aXRsZSxcclxuICAgICAgICB0eXBlOiAnYmFyJyxcclxuICAgICAgICBkYXRhOiByb3dzLm1hcCgocm93OiBhbnkpID0+IFhFVXRpbHMuZ2V0KHJvdywgY29sdW1uLnByb3BlcnR5KSlcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgICBjb25zdCBvcHRpb24gPSB7XHJcbiAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICB0cmlnZ2VyOiAnYXhpcycsXHJcbiAgICAgICAgYXhpc1BvaW50ZXI6IHtcclxuICAgICAgICAgIHR5cGU6ICdzaGFkb3cnXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBsZWdlbmQ6IGxlZ2VuZE9wdHMsXHJcbiAgICAgIHhBeGlzOiB4QXhpc09wdHMsXHJcbiAgICAgIHlBeGlzOiB7XHJcbiAgICAgICAgdHlwZTogJ3ZhbHVlJ1xyXG4gICAgICB9LFxyXG4gICAgICBzZXJpZXM6IHNlcmllc09wdHNcclxuICAgIH1cclxuICAgIHJldHVybiBvcHRpb25cclxuICB9KSxcclxuICBDSEFSVF9CQVJfWV9BWElTOiBjcmVhdGVDaGFydE1vZGFsKChwYXJhbXM6IGFueSkgPT4ge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUgfSA9IHBhcmFtc1xyXG4gICAgY29uc3QgeyByb3dzLCBjb2x1bW5zIH0gPSAkdGFibGUuZ2V0TW91c2VDaGVja2VkcygpXHJcbiAgICBjb25zdCB7IHBhcmFtczogY2hhcnRQYXJhbXMgPSB7fSB9ID0gbWVudVxyXG4gICAgY29uc3QgeyBjYXRlZ29yeSB9ID0gY2hhcnRQYXJhbXNcclxuICAgIGxldCBjYXRlZ29yeUNvbHVtbiA9ICR0YWJsZS5nZXRDb2x1bW5CeUZpZWxkKGNhdGVnb3J5IHx8IGNvbHVtbnNbMF0ucHJvcGVydHkpXHJcbiAgICBsZXQgc2VyaWVDb2x1bW5zID0gY29sdW1ucy5maWx0ZXIoKGNvbHVtbjogYW55KSA9PiBjb2x1bW4ucHJvcGVydHkgIT09IGNhdGVnb3J5Q29sdW1uLnByb3BlcnR5KVxyXG4gICAgbGV0IGxlZ2VuZE9wdHM6IGxlZ2VuZE9wdHMgPSB7XHJcbiAgICAgIGRhdGE6IFtdXHJcbiAgICB9XHJcbiAgICBsZXQgc2VyaWVzT3B0czogQXJyYXk8YW55PiA9IFtdXHJcbiAgICBsZXQgeEF4aXNPcHRzID0ge1xyXG4gICAgICB0eXBlOiAnY2F0ZWdvcnknLFxyXG4gICAgICBkYXRhOiByb3dzLm1hcCgocm93OiBhbnkpID0+IFhFVXRpbHMuZ2V0KHJvdywgY2F0ZWdvcnlDb2x1bW4ucHJvcGVydHkpKVxyXG4gICAgfVxyXG4gICAgc2VyaWVDb2x1bW5zLmZvckVhY2goKGNvbHVtbjogYW55KSA9PiB7XHJcbiAgICAgIGxlZ2VuZE9wdHMuZGF0YS5wdXNoKGNvbHVtbi50aXRsZSlcclxuICAgICAgc2VyaWVzT3B0cy5wdXNoKHtcclxuICAgICAgICBuYW1lOiBjb2x1bW4udGl0bGUsXHJcbiAgICAgICAgdHlwZTogJ2JhcicsXHJcbiAgICAgICAgZGF0YTogcm93cy5tYXAoKHJvdzogYW55KSA9PiBYRVV0aWxzLmdldChyb3csIGNvbHVtbi5wcm9wZXJ0eSkpXHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gICAgY29uc3Qgb3B0aW9uID0ge1xyXG4gICAgICB0b29sdGlwOiB7XHJcbiAgICAgICAgdHJpZ2dlcjogJ2F4aXMnLFxyXG4gICAgICAgIGF4aXNQb2ludGVyOiB7XHJcbiAgICAgICAgICB0eXBlOiAnc2hhZG93J1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgbGVnZW5kOiBsZWdlbmRPcHRzLFxyXG4gICAgICB4QXhpczogeEF4aXNPcHRzLFxyXG4gICAgICB5QXhpczoge1xyXG4gICAgICAgIHR5cGU6ICd2YWx1ZSdcclxuICAgICAgfSxcclxuICAgICAgc2VyaWVzOiBzZXJpZXNPcHRzXHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3B0aW9uXHJcbiAgfSksXHJcbiAgQ0hBUlRfTElORTogY3JlYXRlQ2hhcnRNb2RhbCgocGFyYW1zOiBhbnkpID0+IHtcclxuICAgIGNvbnN0IHsgJHRhYmxlLCBtZW51IH0gPSBwYXJhbXNcclxuICAgIGNvbnN0IHsgcm93cywgY29sdW1ucyB9ID0gJHRhYmxlLmdldE1vdXNlQ2hlY2tlZHMoKVxyXG4gICAgY29uc3QgeyBwYXJhbXM6IGNoYXJ0UGFyYW1zID0ge30gfSA9IG1lbnVcclxuICAgIGNvbnN0IHsgY2F0ZWdvcnkgfSA9IGNoYXJ0UGFyYW1zXHJcbiAgICBsZXQgY2F0ZWdvcnlDb2x1bW4gPSAkdGFibGUuZ2V0Q29sdW1uQnlGaWVsZChjYXRlZ29yeSB8fCBjb2x1bW5zWzBdLnByb3BlcnR5KVxyXG4gICAgbGV0IHNlcmllQ29sdW1ucyA9IGNvbHVtbnMuZmlsdGVyKChjb2x1bW46IGFueSkgPT4gY29sdW1uLnByb3BlcnR5ICE9PSBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eSlcclxuICAgIGxldCBsZWdlbmRPcHRzOiBsZWdlbmRPcHRzID0ge1xyXG4gICAgICBkYXRhOiBbXVxyXG4gICAgfVxyXG4gICAgbGV0IHNlcmllc09wdHM6IEFycmF5PGFueT4gPSBbXVxyXG4gICAgbGV0IHhBeGlzT3B0cyA9IHtcclxuICAgICAgdHlwZTogJ2NhdGVnb3J5JyxcclxuICAgICAgZGF0YTogcm93cy5tYXAoKHJvdzogYW55KSA9PiBYRVV0aWxzLmdldChyb3csIGNhdGVnb3J5Q29sdW1uLnByb3BlcnR5KSlcclxuICAgIH1cclxuICAgIHNlcmllQ29sdW1ucy5mb3JFYWNoKChjb2x1bW46IGFueSkgPT4ge1xyXG4gICAgICBsZWdlbmRPcHRzLmRhdGEucHVzaChjb2x1bW4udGl0bGUpXHJcbiAgICAgIHNlcmllc09wdHMucHVzaCh7XHJcbiAgICAgICAgbmFtZTogY29sdW1uLnRpdGxlLFxyXG4gICAgICAgIHR5cGU6ICdsaW5lJyxcclxuICAgICAgICBkYXRhOiByb3dzLm1hcCgocm93OiBhbnkpID0+IFhFVXRpbHMuZ2V0KHJvdywgY29sdW1uLnByb3BlcnR5KSlcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgICBsZXQgb3B0aW9uID0ge1xyXG4gICAgICB0b29sdGlwOiB7XHJcbiAgICAgICAgdHJpZ2dlcjogJ2F4aXMnXHJcbiAgICAgIH0sXHJcbiAgICAgIGxlZ2VuZDogbGVnZW5kT3B0cyxcclxuICAgICAgdG9vbGJveDoge1xyXG4gICAgICAgIGZlYXR1cmU6IHtcclxuICAgICAgICAgIHNhdmVBc0ltYWdlOiB7fVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgeEF4aXM6IHhBeGlzT3B0cyxcclxuICAgICAgeUF4aXM6IHtcclxuICAgICAgICB0eXBlOiAndmFsdWUnXHJcbiAgICAgIH0sXHJcbiAgICAgIHNlcmllczogc2VyaWVzT3B0c1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9wdGlvblxyXG4gIH0pLFxyXG4gIENIQVJUX1BJRTogY3JlYXRlQ2hhcnRNb2RhbCgocGFyYW1zOiBhbnkpID0+IHtcclxuICAgIGNvbnN0IHsgJHRhYmxlLCBtZW51IH0gPSBwYXJhbXNcclxuICAgIGNvbnN0IHsgcm93cywgY29sdW1ucyB9ID0gJHRhYmxlLmdldE1vdXNlQ2hlY2tlZHMoKVxyXG4gICAgY29uc3QgeyBwYXJhbXM6IGNoYXJ0UGFyYW1zID0ge30gfSA9IG1lbnVcclxuICAgIGNvbnN0IHsgY2F0ZWdvcnkgfSA9IGNoYXJ0UGFyYW1zXHJcbiAgICBsZXQgY2F0ZWdvcnlDb2x1bW4gPSAkdGFibGUuZ2V0Q29sdW1uQnlGaWVsZChjYXRlZ29yeSB8fCBjb2x1bW5zWzBdLnByb3BlcnR5KVxyXG4gICAgbGV0IHNlcmllQ29sdW1ucyA9IGNvbHVtbnMuZmlsdGVyKChjb2x1bW46IGFueSkgPT4gY29sdW1uLnByb3BlcnR5ICE9PSBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eSlcclxuICAgIGxldCBzZXJpZUNvbHVtbiA9IHNlcmllQ29sdW1uc1swXVxyXG4gICAgbGV0IGxlZ2VuZERhdGEgPSByb3dzLm1hcCgocm93OiBhbnkpID0+IFhFVXRpbHMuZ2V0KHJvdywgY2F0ZWdvcnlDb2x1bW4ucHJvcGVydHkpKVxyXG4gICAgbGV0IHNlcmllc0RhdGE6IEFycmF5PGFueT4gPSBbXVxyXG4gICAgcm93cy5mb3JFYWNoKChyb3c6IGFueSkgPT4ge1xyXG4gICAgICBzZXJpZXNEYXRhLnB1c2goe1xyXG4gICAgICAgIG5hbWU6IFhFVXRpbHMuZ2V0KHJvdywgY2F0ZWdvcnlDb2x1bW4ucHJvcGVydHkpLFxyXG4gICAgICAgIHZhbHVlOiBYRVV0aWxzLmdldChyb3csIHNlcmllQ29sdW1uLnByb3BlcnR5KVxyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICAgIGxldCBvcHRpb24gPSB7XHJcbiAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICB0cmlnZ2VyOiAnaXRlbScsXHJcbiAgICAgICAgZm9ybWF0dGVyOiAne2F9IDxici8+e2J9IDoge2N9ICh7ZH0lKSdcclxuICAgICAgfSxcclxuICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgdHlwZTogJ3Njcm9sbCcsXHJcbiAgICAgICAgb3JpZW50OiAndmVydGljYWwnLFxyXG4gICAgICAgIHJpZ2h0OiAxMCxcclxuICAgICAgICB0b3A6IDIwLFxyXG4gICAgICAgIGJvdHRvbTogMjAsXHJcbiAgICAgICAgZGF0YTogbGVnZW5kRGF0YVxyXG4gICAgICAgIC8vIHNlbGVjdGVkOiBkYXRhLnNlbGVjdGVkXHJcbiAgICAgIH0sXHJcbiAgICAgIHNlcmllczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIG5hbWU6IHNlcmllQ29sdW1uLnRpdGxlLFxyXG4gICAgICAgICAgdHlwZTogJ3BpZScsXHJcbiAgICAgICAgICByYWRpdXM6ICc1MCUnLFxyXG4gICAgICAgICAgY2VudGVyOiBbJzQwJScsICc1MCUnXSxcclxuICAgICAgICAgIGRhdGE6IHNlcmllc0RhdGFcclxuICAgICAgICB9XHJcbiAgICAgIF1cclxuICAgIH1cclxuICAgIHJldHVybiBvcHRpb25cclxuICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBjaGVja1ByaXZpbGVnZSAoaXRlbTogYW55LCBwYXJhbXM6IGFueSkge1xyXG4gIGNvbnN0IHsgJHRhYmxlIH0gPSBwYXJhbXNcclxuICBjb25zdCB7IGNvZGUsIHBhcmFtczogY2hhcnRQYXJhbXMgPSB7fSB9ID0gaXRlbVxyXG4gIHN3aXRjaCAoY29kZSkge1xyXG4gICAgY2FzZSAnQ0hBUlRfQkFSX1hfQVhJUyc6XHJcbiAgICBjYXNlICdDSEFSVF9CQVJfWV9BWElTJzpcclxuICAgIGNhc2UgJ0NIQVJUX0xJTkUnOiB7XHJcbiAgICAgIGNvbnN0IHsgcm93cywgY29sdW1ucyB9ID0gJHRhYmxlLmdldE1vdXNlQ2hlY2tlZHMoKVxyXG4gICAgICBjb25zdCB7IGNhdGVnb3J5IH0gPSBjaGFydFBhcmFtc1xyXG4gICAgICBpZiAoY2F0ZWdvcnkpIHtcclxuICAgICAgICBsZXQgc2VyaWVDb2x1bW5zID0gY29sdW1ucy5maWx0ZXIoKGNvbHVtbjogYW55KSA9PiBjb2x1bW4ucHJvcGVydHkgIT09IGNhdGVnb3J5KVxyXG4gICAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhcm93cy5sZW5ndGggfHwgc2VyaWVDb2x1bW5zLmxlbmd0aCA8IDFcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpdGVtLmRpc2FibGVkID0gIXJvd3MubGVuZ3RoIHx8IGNvbHVtbnMubGVuZ3RoIDwgMlxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAgIGJyZWFrXHJcbiAgICBjYXNlICdDSEFSVF9QSUUnOiB7XHJcbiAgICAgIGNvbnN0IHsgcm93cywgY29sdW1ucyB9ID0gJHRhYmxlLmdldE1vdXNlQ2hlY2tlZHMoKVxyXG4gICAgICBjb25zdCB7IGNhdGVnb3J5IH0gPSBjaGFydFBhcmFtc1xyXG4gICAgICBpZiAoY2F0ZWdvcnkpIHtcclxuICAgICAgICBsZXQgc2VyaWVDb2x1bW5zID0gY29sdW1ucy5maWx0ZXIoKGNvbHVtbjogYW55KSA9PiBjb2x1bW4ucHJvcGVydHkgIT09IGNhdGVnb3J5KVxyXG4gICAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhcm93cy5sZW5ndGggfHwgc2VyaWVDb2x1bW5zLmxlbmd0aCAhPT0gMVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhcm93cy5sZW5ndGggfHwgY29sdW1ucy5sZW5ndGggIT09IDJcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgICBicmVha1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJpdmlsZWdlRXZlbnQgKHBhcmFtczogYW55KSB7XHJcbiAgcGFyYW1zLm9wdGlvbnMuZm9yRWFjaCgobGlzdDogQXJyYXk8YW55PikgPT4ge1xyXG4gICAgbGlzdC5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcclxuICAgICAgY2hlY2tQcml2aWxlZ2UoaXRlbSwgcGFyYW1zKVxyXG4gICAgICBpZiAoaXRlbS5jaGlsZHJlbikge1xyXG4gICAgICAgIGl0ZW0uY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQ6IGFueSkgPT4ge1xyXG4gICAgICAgICAgY2hlY2tQcml2aWxlZ2UoY2hpbGQsIHBhcmFtcylcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiDln7rkuo4gdnhlLXRhYmxlIOihqOagvOeahOWbvuihqOa4suafk+aPkuS7tlxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IFZYRVRhYmxlUGx1Z2luQ2hhcnRzID0ge1xyXG4gIGluc3RhbGwgKHh0YWJsZTogdHlwZW9mIFZYRVRhYmxlKSB7XHJcbiAgICBsZXQgeyBpbnRlcmNlcHRvciwgbWVudXMsIF9tb2RhbCB9ID0geHRhYmxlXHJcbiAgICBpZiAoIV9tb2RhbCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1t2eGUtdGFibGUtcGx1Z2luLWNoYXJ0c10gcmVxdWlyZSBNb2RhbCBtb2R1bGUuJylcclxuICAgIH1cclxuICAgIGludGVyY2VwdG9yLmFkZCgnZXZlbnQuc2hvd19tZW51JywgaGFuZGxlUHJpdmlsZWdlRXZlbnQpXHJcbiAgICBtZW51cy5taXhpbihtZW51TWFwKVxyXG4gIH1cclxufVxyXG5cclxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5WWEVUYWJsZSkge1xyXG4gIHdpbmRvdy5WWEVUYWJsZS51c2UoVlhFVGFibGVQbHVnaW5DaGFydHMpXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFZYRVRhYmxlUGx1Z2luQ2hhcnRzXHJcbiJdfQ==

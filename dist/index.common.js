"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.VXETablePluginCharts = void 0;

var _xeUtils = _interopRequireDefault(require("xe-utils/methods/xe-utils"));

var echarts = _interopRequireWildcard(require("echarts/lib/echarts"));

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { "default": obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj["default"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function createChartModal(getOptions) {
  return function (params) {
    var $table = params.$table,
        menu = params.menu;
    var chartModals = $table.chartModals;

    if (!chartModals) {
      chartModals = $table.chartModals = [];
    }

    var opts = {
      id: _xeUtils["default"].uniqueId(),
      resize: true,
      mask: false,
      lockView: false,
      showFooter: false,
      width: 600,
      height: 400,
      title: menu.name,
      slots: {
        "default": function _default(params, h) {
          return [h('div', {
            "class": 'vxe-chart--wrapper'
          }, [h('div', {
            "class": 'vxe-chart--panel'
          })])];
        }
      },
      events: {
        show: function show(_ref) {
          var $modal = _ref.$modal;
          var $chart = echarts.init($modal.$el.querySelector('.vxe-chart--wrapper'));
          $chart.setOption(getOptions(params));
          $modal.$chart = $chart;
        },
        close: function close(_ref2) {
          var $modal = _ref2.$modal;

          // 旧版本，即将废弃
          _xeUtils["default"].remove(chartModals, function (id) {
            return id === $modal.id;
          });

          $modal.$chart.dispose();
          $modal.$chart = null;
        },
        hide: function hide(_ref3) {
          var $modal = _ref3.$modal;

          _xeUtils["default"].remove(chartModals, function (id) {
            return id === $modal.id;
          });

          $modal.$chart.dispose();
          $modal.$chart = null;
        },
        zoom: function zoom(_ref4) {
          var $modal = _ref4.$modal;
          $modal.$chart.resize();
        }
      }
    };
    chartModals.push(opts.id);

    if (this.$XModal.open) {
      this.$XModal.open(opts);
    } else {
      // 旧版本，即将废弃
      this.$XModal(opts);
    }
  };
}

var menuMap = {
  CHART_BAR_X_AXIS: createChartModal(function (params) {
    var $table = params.$table,
        menu = params.menu;

    var _ref5 = $table.getSelectedRanges ? $table.getSelectedRanges() : $table.getMouseCheckeds(),
        rows = _ref5.rows,
        columns = _ref5.columns;

    var _menu$params = menu.params,
        chartParams = _menu$params === void 0 ? {} : _menu$params;
    var category = chartParams.category;
    var categoryColumn = $table.getColumnByField(category || columns[0].property);
    var serieColumns = columns.filter(function (column) {
      return column.property !== categoryColumn.property;
    });
    var legendOpts = {
      data: []
    };
    var seriesOpts = [];
    var xAxisOpts = {
      type: 'category',
      data: rows.map(function (row) {
        return _xeUtils["default"].get(row, categoryColumn.property);
      })
    };
    serieColumns.forEach(function (column) {
      legendOpts.data.push(column.title);
      seriesOpts.push({
        name: column.title,
        type: 'bar',
        data: rows.map(function (row) {
          return _xeUtils["default"].get(row, column.property);
        })
      });
    });
    var option = {
      tooltip: {
        trigger: 'axis',
        axisPointer: {
          type: 'shadow'
        }
      },
      legend: legendOpts,
      xAxis: xAxisOpts,
      yAxis: {
        type: 'value'
      },
      series: seriesOpts
    };
    return option;
  }),
  CHART_BAR_Y_AXIS: createChartModal(function (params) {
    var $table = params.$table,
        menu = params.menu;

    var _ref6 = $table.getSelectedRanges ? $table.getSelectedRanges() : $table.getMouseCheckeds(),
        rows = _ref6.rows,
        columns = _ref6.columns;

    var _menu$params2 = menu.params,
        chartParams = _menu$params2 === void 0 ? {} : _menu$params2;
    var category = chartParams.category;
    var categoryColumn = $table.getColumnByField(category || columns[0].property);
    var serieColumns = columns.filter(function (column) {
      return column.property !== categoryColumn.property;
    });
    var legendOpts = {
      data: []
    };
    var seriesOpts = [];
    var xAxisOpts = {
      type: 'category',
      data: rows.map(function (row) {
        return _xeUtils["default"].get(row, categoryColumn.property);
      })
    };
    serieColumns.forEach(function (column) {
      legendOpts.data.push(column.title);
      seriesOpts.push({
        name: column.title,
        type: 'bar',
        data: rows.map(function (row) {
          return _xeUtils["default"].get(row, column.property);
        })
      });
    });
    var option = {
      tooltip: {
        trigger: 'axis',
        axisPointer: {
          type: 'shadow'
        }
      },
      legend: legendOpts,
      xAxis: xAxisOpts,
      yAxis: {
        type: 'value'
      },
      series: seriesOpts
    };
    return option;
  }),
  CHART_LINE: createChartModal(function (params) {
    var $table = params.$table,
        menu = params.menu;

    var _ref7 = $table.getSelectedRanges ? $table.getSelectedRanges() : $table.getMouseCheckeds(),
        rows = _ref7.rows,
        columns = _ref7.columns;

    var _menu$params3 = menu.params,
        chartParams = _menu$params3 === void 0 ? {} : _menu$params3;
    var category = chartParams.category;
    var categoryColumn = $table.getColumnByField(category || columns[0].property);
    var serieColumns = columns.filter(function (column) {
      return column.property !== categoryColumn.property;
    });
    var legendOpts = {
      data: []
    };
    var seriesOpts = [];
    var xAxisOpts = {
      type: 'category',
      data: rows.map(function (row) {
        return _xeUtils["default"].get(row, categoryColumn.property);
      })
    };
    serieColumns.forEach(function (column) {
      legendOpts.data.push(column.title);
      seriesOpts.push({
        name: column.title,
        type: 'line',
        data: rows.map(function (row) {
          return _xeUtils["default"].get(row, column.property);
        })
      });
    });
    var option = {
      tooltip: {
        trigger: 'axis'
      },
      legend: legendOpts,
      toolbox: {
        feature: {
          saveAsImage: {}
        }
      },
      xAxis: xAxisOpts,
      yAxis: {
        type: 'value'
      },
      series: seriesOpts
    };
    return option;
  }),
  CHART_PIE: createChartModal(function (params) {
    var $table = params.$table,
        menu = params.menu;

    var _ref8 = $table.getSelectedRanges ? $table.getSelectedRanges() : $table.getMouseCheckeds(),
        rows = _ref8.rows,
        columns = _ref8.columns;

    var _menu$params4 = menu.params,
        chartParams = _menu$params4 === void 0 ? {} : _menu$params4;
    var category = chartParams.category;
    var categoryColumn = $table.getColumnByField(category || columns[0].property);
    var serieColumns = columns.filter(function (column) {
      return column.property !== categoryColumn.property;
    });
    var serieColumn = serieColumns[0];
    var legendData = rows.map(function (row) {
      return _xeUtils["default"].get(row, categoryColumn.property);
    });
    var seriesData = [];
    rows.forEach(function (row) {
      seriesData.push({
        name: _xeUtils["default"].get(row, categoryColumn.property),
        value: _xeUtils["default"].get(row, serieColumn.property)
      });
    });
    var option = {
      tooltip: {
        trigger: 'item',
        formatter: '{a} <br/>{b} : {c} ({d}%)'
      },
      legend: {
        type: 'scroll',
        orient: 'vertical',
        right: 10,
        top: 20,
        bottom: 20,
        data: legendData // selected: data.selected

      },
      series: [{
        name: serieColumn.title,
        type: 'pie',
        radius: '50%',
        center: ['40%', '50%'],
        data: seriesData
      }]
    };
    return option;
  })
};

function checkPrivilege(item, params) {
  var $table = params.$table;
  var code = item.code,
      _item$params = item.params,
      chartParams = _item$params === void 0 ? {} : _item$params;

  switch (code) {
    case 'CHART_BAR_X_AXIS':
    case 'CHART_BAR_Y_AXIS':
    case 'CHART_LINE':
      {
        var _ref9 = $table.getSelectedRanges ? $table.getSelectedRanges() : $table.getMouseCheckeds(),
            rows = _ref9.rows,
            columns = _ref9.columns;

        var category = chartParams.category;

        if (category) {
          var serieColumns = columns.filter(function (column) {
            return column.property !== category;
          });
          item.disabled = !rows.length || serieColumns.length < 1;
        } else {
          item.disabled = !rows.length || columns.length < 2;
        }
      }
      break;

    case 'CHART_PIE':
      {
        var _ref10 = $table.getSelectedRanges ? $table.getSelectedRanges() : $table.getMouseCheckeds(),
            _rows = _ref10.rows,
            _columns = _ref10.columns;

        var _category = chartParams.category;

        if (_category) {
          var _serieColumns = _columns.filter(function (column) {
            return column.property !== _category;
          });

          item.disabled = !_rows.length || _serieColumns.length !== 1;
        } else {
          item.disabled = !_rows.length || _columns.length !== 2;
        }
      }
      break;
  }
}

function handleBeforeDestroyEvent(_ref11) {
  var $table = _ref11.$table;
  var $XModal = $table.$XModal,
      chartModals = $table.chartModals;

  if (chartModals) {
    if ($XModal.close) {
      chartModals.forEach(function (id) {
        return $XModal.close(id);
      });
    } else {
      // 旧版本，即将废弃
      $XModal.closeAll();
    }
  }
}

function handlePrivilegeEvent(params) {
  params.options.forEach(function (list) {
    list.forEach(function (item) {
      checkPrivilege(item, params);

      if (item.children) {
        item.children.forEach(function (child) {
          checkPrivilege(child, params);
        });
      }
    });
  });
}
/**
 * 基于 vxe-table 表格的图表渲染插件
 */


var VXETablePluginCharts = {
  install: function install(xtable) {
    var v = xtable.v,
        interceptor = xtable.interceptor,
        menus = xtable.menus,
        _modal = xtable._modal;

    if (!_modal) {
      throw new Error('[vxe-table-plugin-charts] require Modal module.');
    }

    if (v !== 'v2') {
      throw new Error('[vxe-table-plugin-charts] V2 version is required.');
    }

    interceptor.add('beforeDestroy', handleBeforeDestroyEvent);
    interceptor.add('event.showMenu', handlePrivilegeEvent);
    menus.mixin(menuMap);
  }
};
exports.VXETablePluginCharts = VXETablePluginCharts;

if (typeof window !== 'undefined' && window.VXETable) {
  window.VXETable.use(VXETablePluginCharts);
}

var _default2 = VXETablePluginCharts;
exports["default"] = _default2;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRzIl0sIm5hbWVzIjpbImNyZWF0ZUNoYXJ0TW9kYWwiLCJnZXRPcHRpb25zIiwicGFyYW1zIiwiJHRhYmxlIiwibWVudSIsImNoYXJ0TW9kYWxzIiwib3B0cyIsImlkIiwiWEVVdGlscyIsInVuaXF1ZUlkIiwicmVzaXplIiwibWFzayIsImxvY2tWaWV3Iiwic2hvd0Zvb3RlciIsIndpZHRoIiwiaGVpZ2h0IiwidGl0bGUiLCJuYW1lIiwic2xvdHMiLCJoIiwiZXZlbnRzIiwic2hvdyIsIiRtb2RhbCIsIiRjaGFydCIsImVjaGFydHMiLCJpbml0IiwiJGVsIiwicXVlcnlTZWxlY3RvciIsInNldE9wdGlvbiIsImNsb3NlIiwicmVtb3ZlIiwiZGlzcG9zZSIsImhpZGUiLCJ6b29tIiwicHVzaCIsIiRYTW9kYWwiLCJvcGVuIiwibWVudU1hcCIsIkNIQVJUX0JBUl9YX0FYSVMiLCJnZXRTZWxlY3RlZFJhbmdlcyIsImdldE1vdXNlQ2hlY2tlZHMiLCJyb3dzIiwiY29sdW1ucyIsImNoYXJ0UGFyYW1zIiwiY2F0ZWdvcnkiLCJjYXRlZ29yeUNvbHVtbiIsImdldENvbHVtbkJ5RmllbGQiLCJwcm9wZXJ0eSIsInNlcmllQ29sdW1ucyIsImZpbHRlciIsImNvbHVtbiIsImxlZ2VuZE9wdHMiLCJkYXRhIiwic2VyaWVzT3B0cyIsInhBeGlzT3B0cyIsInR5cGUiLCJtYXAiLCJyb3ciLCJnZXQiLCJmb3JFYWNoIiwib3B0aW9uIiwidG9vbHRpcCIsInRyaWdnZXIiLCJheGlzUG9pbnRlciIsImxlZ2VuZCIsInhBeGlzIiwieUF4aXMiLCJzZXJpZXMiLCJDSEFSVF9CQVJfWV9BWElTIiwiQ0hBUlRfTElORSIsInRvb2xib3giLCJmZWF0dXJlIiwic2F2ZUFzSW1hZ2UiLCJDSEFSVF9QSUUiLCJzZXJpZUNvbHVtbiIsImxlZ2VuZERhdGEiLCJzZXJpZXNEYXRhIiwidmFsdWUiLCJmb3JtYXR0ZXIiLCJvcmllbnQiLCJyaWdodCIsInRvcCIsImJvdHRvbSIsInJhZGl1cyIsImNlbnRlciIsImNoZWNrUHJpdmlsZWdlIiwiaXRlbSIsImNvZGUiLCJkaXNhYmxlZCIsImxlbmd0aCIsImhhbmRsZUJlZm9yZURlc3Ryb3lFdmVudCIsImNsb3NlQWxsIiwiaGFuZGxlUHJpdmlsZWdlRXZlbnQiLCJvcHRpb25zIiwibGlzdCIsImNoaWxkcmVuIiwiY2hpbGQiLCJWWEVUYWJsZVBsdWdpbkNoYXJ0cyIsImluc3RhbGwiLCJ4dGFibGUiLCJ2IiwiaW50ZXJjZXB0b3IiLCJtZW51cyIsIl9tb2RhbCIsIkVycm9yIiwiYWRkIiwibWl4aW4iLCJ3aW5kb3ciLCJWWEVUYWJsZSIsInVzZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7O0FBRUE7Ozs7Ozs7O0FBRUEsU0FBU0EsZ0JBQVQsQ0FBMkJDLFVBQTNCLEVBQTBDO0FBQ3hDLFNBQU8sVUFBcUJDLE1BQXJCLEVBQWdDO0FBQUEsUUFDL0JDLE1BRCtCLEdBQ2RELE1BRGMsQ0FDL0JDLE1BRCtCO0FBQUEsUUFDdkJDLElBRHVCLEdBQ2RGLE1BRGMsQ0FDdkJFLElBRHVCO0FBRXJDLFFBQUlDLFdBQVcsR0FBYUYsTUFBTSxDQUFDRSxXQUFuQzs7QUFDQSxRQUFJLENBQUNBLFdBQUwsRUFBa0I7QUFDaEJBLE1BQUFBLFdBQVcsR0FBR0YsTUFBTSxDQUFDRSxXQUFQLEdBQXFCLEVBQW5DO0FBQ0Q7O0FBQ0QsUUFBTUMsSUFBSSxHQUFHO0FBQ1hDLE1BQUFBLEVBQUUsRUFBRUMsb0JBQVFDLFFBQVIsRUFETztBQUVYQyxNQUFBQSxNQUFNLEVBQUUsSUFGRztBQUdYQyxNQUFBQSxJQUFJLEVBQUUsS0FISztBQUlYQyxNQUFBQSxRQUFRLEVBQUUsS0FKQztBQUtYQyxNQUFBQSxVQUFVLEVBQUUsS0FMRDtBQU1YQyxNQUFBQSxLQUFLLEVBQUUsR0FOSTtBQU9YQyxNQUFBQSxNQUFNLEVBQUUsR0FQRztBQVFYQyxNQUFBQSxLQUFLLEVBQUVaLElBQUksQ0FBQ2EsSUFSRDtBQVNYQyxNQUFBQSxLQUFLLEVBQUU7QUFBQSxxQ0FD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O0FBR08sSUFBTStGLG9CQUFvQixHQUFHO0FBQ2xDQyxFQUFBQSxPQURrQyxtQkFDekJDLE1BRHlCLEVBQ0Y7QUFBQSxRQUN4QkMsQ0FEd0IsR0FDVUQsTUFEVixDQUN4QkMsQ0FEd0I7QUFBQSxRQUNyQkMsV0FEcUIsR0FDVUYsTUFEVixDQUNyQkUsV0FEcUI7QUFBQSxRQUNSQyxLQURRLEdBQ1VILE1BRFYsQ0FDUkcsS0FEUTtBQUFBLFFBQ0RDLE1BREMsR0FDVUosTUFEVixDQUNESSxNQURDOztBQUU5QixRQUFJLENBQUNBLE1BQUwsRUFBYTtBQUNYLFlBQU0sSUFBSUMsS0FBSixDQUFVLGlEQUFWLENBQU47QUFDRDs7QUFDRCxRQUFJSixDQUFDLEtBQUssSUFBVixFQUFnQjtBQUNkLFlBQU0sSUFBSUksS0FBSixDQUFVLG1EQUFWLENBQU47QUFDRDs7QUFDREgsSUFBQUEsV0FBVyxDQUFDSSxHQUFaLENBQWdCLGVBQWhCLEVBQWlDZix3QkFBakM7QUFDQVcsSUFBQUEsV0FBVyxDQUFDSSxHQUFaLENBQWdCLGdCQUFoQixFQUFrQ2Isb0JBQWxDO0FBQ0FVLElBQUFBLEtBQUssQ0FBQ0ksS0FBTixDQUFZckUsT0FBWjtBQUNEO0FBWmlDLENBQTdCOzs7QUFlUCxJQUFJLE9BQU9zRSxNQUFQLEtBQWtCLFdBQWxCLElBQWlDQSxNQUFNLENBQUNDLFFBQTVDLEVBQXNEO0FBQ3BERCxFQUFBQSxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JDLEdBQWhCLENBQW9CWixvQkFBcEI7QUFDRDs7Z0JBRWNBLG9CIiwiZmlsZSI6ImluZGV4LmNvbW1vbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBYRVV0aWxzIGZyb20gJ3hlLXV0aWxzL21ldGhvZHMveGUtdXRpbHMnXHJcbmltcG9ydCBWWEVUYWJsZSBmcm9tICd2eGUtdGFibGUvbGliL3Z4ZS10YWJsZSdcclxuaW1wb3J0ICogYXMgZWNoYXJ0cyBmcm9tICdlY2hhcnRzL2xpYi9lY2hhcnRzJ1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2hhcnRNb2RhbCAoZ2V0T3B0aW9uczogYW55KSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uICh0aGlzOiBhbnksIHBhcmFtczogYW55KSB7XHJcbiAgICBsZXQgeyAkdGFibGUsIG1lbnUgfSA9IHBhcmFtc1xyXG4gICAgbGV0IGNoYXJ0TW9kYWxzOiBzdHJpbmdbXSA9ICR0YWJsZS5jaGFydE1vZGFsc1xyXG4gICAgaWYgKCFjaGFydE1vZGFscykge1xyXG4gICAgICBjaGFydE1vZGFscyA9ICR0YWJsZS5jaGFydE1vZGFscyA9IFtdXHJcbiAgICB9XHJcbiAgICBjb25zdCBvcHRzID0ge1xyXG4gICAgICBpZDogWEVVdGlscy51bmlxdWVJZCgpLFxyXG4gICAgICByZXNpemU6IHRydWUsXHJcbiAgICAgIG1hc2s6IGZhbHNlLFxyXG4gICAgICBsb2NrVmlldzogZmFsc2UsXHJcbiAgICAgIHNob3dGb290ZXI6IGZhbHNlLFxyXG4gICAgICB3aWR0aDogNjAwLFxyXG4gICAgICBoZWlnaHQ6IDQwMCxcclxuICAgICAgdGl0bGU6IG1lbnUubmFtZSxcclxuICAgICAgc2xvdHM6IHtcclxuICAgICAgICBkZWZhdWx0IChwYXJhbXM6IGFueSwgaDogRnVuY3Rpb24pIHtcclxuICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIGgoJ2RpdicsIHtcclxuICAgICAgICAgICAgICBjbGFzczogJ3Z4ZS1jaGFydC0td3JhcHBlcidcclxuICAgICAgICAgICAgfSwgW1xyXG4gICAgICAgICAgICAgIGgoJ2RpdicsIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzOiAndnhlLWNoYXJ0LS1wYW5lbCdcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICBdKVxyXG4gICAgICAgICAgXVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgc2hvdyAoeyAkbW9kYWwgfTogYW55KSB7XHJcbiAgICAgICAgICBjb25zdCAkY2hhcnQgPSBlY2hhcnRzLmluaXQoJG1vZGFsLiRlbC5xdWVyeVNlbGVjdG9yKCcudnhlLWNoYXJ0LS13cmFwcGVyJykpXHJcbiAgICAgICAgICAkY2hhcnQuc2V0T3B0aW9uKGdldE9wdGlvbnMocGFyYW1zKSlcclxuICAgICAgICAgICRtb2RhbC4kY2hhcnQgPSAkY2hhcnRcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNsb3NlICh7ICRtb2RhbCB9OiBhbnkpIHtcclxuICAgICAgICAgIC8vIOaXp+eJiOacrO+8jOWNs+WwhuW6n+W8g1xyXG4gICAgICAgICAgWEVVdGlscy5yZW1vdmUoY2hhcnRNb2RhbHMsIGlkID0+IGlkID09PSAkbW9kYWwuaWQpXHJcbiAgICAgICAgICAkbW9kYWwuJGNoYXJ0LmRpc3Bvc2UoKVxyXG4gICAgICAgICAgJG1vZGFsLiRjaGFydCA9IG51bGxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGhpZGUgKHsgJG1vZGFsIH06IGFueSkge1xyXG4gICAgICAgICAgWEVVdGlscy5yZW1vdmUoY2hhcnRNb2RhbHMsIGlkID0+IGlkID09PSAkbW9kYWwuaWQpXHJcbiAgICAgICAgICAkbW9kYWwuJGNoYXJ0LmRpc3Bvc2UoKVxyXG4gICAgICAgICAgJG1vZGFsLiRjaGFydCA9IG51bGxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHpvb20gKHsgJG1vZGFsIH06IGFueSkge1xyXG4gICAgICAgICAgJG1vZGFsLiRjaGFydC5yZXNpemUoKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgY2hhcnRNb2RhbHMucHVzaChvcHRzLmlkKVxyXG4gICAgaWYgKHRoaXMuJFhNb2RhbC5vcGVuKSB7XHJcbiAgICAgIHRoaXMuJFhNb2RhbC5vcGVuKG9wdHMpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyDml6fniYjmnKzvvIzljbPlsIblup/lvINcclxuICAgICAgdGhpcy4kWE1vZGFsKG9wdHMpXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5pbnRlcmZhY2UgbGVnZW5kT3B0cyB7XHJcbiAgZGF0YTogQXJyYXk8YW55PjtcclxufVxyXG5cclxuY29uc3QgbWVudU1hcCA9IHtcclxuICBDSEFSVF9CQVJfWF9BWElTOiBjcmVhdGVDaGFydE1vZGFsKChwYXJhbXM6IGFueSkgPT4ge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUgfSA9IHBhcmFtc1xyXG4gICAgY29uc3QgeyByb3dzLCBjb2x1bW5zIH0gPSAkdGFibGUuZ2V0U2VsZWN0ZWRSYW5nZXMgPyAkdGFibGUuZ2V0U2VsZWN0ZWRSYW5nZXMoKSA6ICR0YWJsZS5nZXRNb3VzZUNoZWNrZWRzKClcclxuICAgIGNvbnN0IHsgcGFyYW1zOiBjaGFydFBhcmFtcyA9IHt9IH0gPSBtZW51XHJcbiAgICBjb25zdCB7IGNhdGVnb3J5IH0gPSBjaGFydFBhcmFtc1xyXG4gICAgbGV0IGNhdGVnb3J5Q29sdW1uID0gJHRhYmxlLmdldENvbHVtbkJ5RmllbGQoY2F0ZWdvcnkgfHwgY29sdW1uc1swXS5wcm9wZXJ0eSlcclxuICAgIGxldCBzZXJpZUNvbHVtbnMgPSBjb2x1bW5zLmZpbHRlcigoY29sdW1uOiBhbnkpID0+IGNvbHVtbi5wcm9wZXJ0eSAhPT0gY2F0ZWdvcnlDb2x1bW4ucHJvcGVydHkpXHJcbiAgICBsZXQgbGVnZW5kT3B0czogbGVnZW5kT3B0cyA9IHtcclxuICAgICAgZGF0YTogW11cclxuICAgIH1cclxuICAgIGxldCBzZXJpZXNPcHRzOiBBcnJheTxhbnk+ID0gW11cclxuICAgIGxldCB4QXhpc09wdHMgPSB7XHJcbiAgICAgIHR5cGU6ICdjYXRlZ29yeScsXHJcbiAgICAgIGRhdGE6IHJvd3MubWFwKChyb3c6IGFueSkgPT4gWEVVdGlscy5nZXQocm93LCBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eSkpXHJcbiAgICB9XHJcbiAgICBzZXJpZUNvbHVtbnMuZm9yRWFjaCgoY29sdW1uOiBhbnkpID0+IHtcclxuICAgICAgbGVnZW5kT3B0cy5kYXRhLnB1c2goY29sdW1uLnRpdGxlKVxyXG4gICAgICBzZXJpZXNPcHRzLnB1c2goe1xyXG4gICAgICAgIG5hbWU6IGNvbHVtbi50aXRsZSxcclxuICAgICAgICB0eXBlOiAnYmFyJyxcclxuICAgICAgICBkYXRhOiByb3dzLm1hcCgocm93OiBhbnkpID0+IFhFVXRpbHMuZ2V0KHJvdywgY29sdW1uLnByb3BlcnR5KSlcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgICBjb25zdCBvcHRpb24gPSB7XHJcbiAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICB0cmlnZ2VyOiAnYXhpcycsXHJcbiAgICAgICAgYXhpc1BvaW50ZXI6IHtcclxuICAgICAgICAgIHR5cGU6ICdzaGFkb3cnXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBsZWdlbmQ6IGxlZ2VuZE9wdHMsXHJcbiAgICAgIHhBeGlzOiB4QXhpc09wdHMsXHJcbiAgICAgIHlBeGlzOiB7XHJcbiAgICAgICAgdHlwZTogJ3ZhbHVlJ1xyXG4gICAgICB9LFxyXG4gICAgICBzZXJpZXM6IHNlcmllc09wdHNcclxuICAgIH1cclxuICAgIHJldHVybiBvcHRpb25cclxuICB9KSxcclxuICBDSEFSVF9CQVJfWV9BWElTOiBjcmVhdGVDaGFydE1vZGFsKChwYXJhbXM6IGFueSkgPT4ge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUgfSA9IHBhcmFtc1xyXG4gICAgY29uc3QgeyByb3dzLCBjb2x1bW5zIH0gPSAkdGFibGUuZ2V0U2VsZWN0ZWRSYW5nZXMgPyAkdGFibGUuZ2V0U2VsZWN0ZWRSYW5nZXMoKSA6ICR0YWJsZS5nZXRNb3VzZUNoZWNrZWRzKClcclxuICAgIGNvbnN0IHsgcGFyYW1zOiBjaGFydFBhcmFtcyA9IHt9IH0gPSBtZW51XHJcbiAgICBjb25zdCB7IGNhdGVnb3J5IH0gPSBjaGFydFBhcmFtc1xyXG4gICAgbGV0IGNhdGVnb3J5Q29sdW1uID0gJHRhYmxlLmdldENvbHVtbkJ5RmllbGQoY2F0ZWdvcnkgfHwgY29sdW1uc1swXS5wcm9wZXJ0eSlcclxuICAgIGxldCBzZXJpZUNvbHVtbnMgPSBjb2x1bW5zLmZpbHRlcigoY29sdW1uOiBhbnkpID0+IGNvbHVtbi5wcm9wZXJ0eSAhPT0gY2F0ZWdvcnlDb2x1bW4ucHJvcGVydHkpXHJcbiAgICBsZXQgbGVnZW5kT3B0czogbGVnZW5kT3B0cyA9IHtcclxuICAgICAgZGF0YTogW11cclxuICAgIH1cclxuICAgIGxldCBzZXJpZXNPcHRzOiBBcnJheTxhbnk+ID0gW11cclxuICAgIGxldCB4QXhpc09wdHMgPSB7XHJcbiAgICAgIHR5cGU6ICdjYXRlZ29yeScsXHJcbiAgICAgIGRhdGE6IHJvd3MubWFwKChyb3c6IGFueSkgPT4gWEVVdGlscy5nZXQocm93LCBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eSkpXHJcbiAgICB9XHJcbiAgICBzZXJpZUNvbHVtbnMuZm9yRWFjaCgoY29sdW1uOiBhbnkpID0+IHtcclxuICAgICAgbGVnZW5kT3B0cy5kYXRhLnB1c2goY29sdW1uLnRpdGxlKVxyXG4gICAgICBzZXJpZXNPcHRzLnB1c2goe1xyXG4gICAgICAgIG5hbWU6IGNvbHVtbi50aXRsZSxcclxuICAgICAgICB0eXBlOiAnYmFyJyxcclxuICAgICAgICBkYXRhOiByb3dzLm1hcCgocm93OiBhbnkpID0+IFhFVXRpbHMuZ2V0KHJvdywgY29sdW1uLnByb3BlcnR5KSlcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgICBjb25zdCBvcHRpb24gPSB7XHJcbiAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICB0cmlnZ2VyOiAnYXhpcycsXHJcbiAgICAgICAgYXhpc1BvaW50ZXI6IHtcclxuICAgICAgICAgIHR5cGU6ICdzaGFkb3cnXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBsZWdlbmQ6IGxlZ2VuZE9wdHMsXHJcbiAgICAgIHhBeGlzOiB4QXhpc09wdHMsXHJcbiAgICAgIHlBeGlzOiB7XHJcbiAgICAgICAgdHlwZTogJ3ZhbHVlJ1xyXG4gICAgICB9LFxyXG4gICAgICBzZXJpZXM6IHNlcmllc09wdHNcclxuICAgIH1cclxuICAgIHJldHVybiBvcHRpb25cclxuICB9KSxcclxuICBDSEFSVF9MSU5FOiBjcmVhdGVDaGFydE1vZGFsKChwYXJhbXM6IGFueSkgPT4ge1xyXG4gICAgY29uc3QgeyAkdGFibGUsIG1lbnUgfSA9IHBhcmFtc1xyXG4gICAgY29uc3QgeyByb3dzLCBjb2x1bW5zIH0gPSAkdGFibGUuZ2V0U2VsZWN0ZWRSYW5nZXMgPyAkdGFibGUuZ2V0U2VsZWN0ZWRSYW5nZXMoKSA6ICR0YWJsZS5nZXRNb3VzZUNoZWNrZWRzKClcclxuICAgIGNvbnN0IHsgcGFyYW1zOiBjaGFydFBhcmFtcyA9IHt9IH0gPSBtZW51XHJcbiAgICBjb25zdCB7IGNhdGVnb3J5IH0gPSBjaGFydFBhcmFtc1xyXG4gICAgbGV0IGNhdGVnb3J5Q29sdW1uID0gJHRhYmxlLmdldENvbHVtbkJ5RmllbGQoY2F0ZWdvcnkgfHwgY29sdW1uc1swXS5wcm9wZXJ0eSlcclxuICAgIGxldCBzZXJpZUNvbHVtbnMgPSBjb2x1bW5zLmZpbHRlcigoY29sdW1uOiBhbnkpID0+IGNvbHVtbi5wcm9wZXJ0eSAhPT0gY2F0ZWdvcnlDb2x1bW4ucHJvcGVydHkpXHJcbiAgICBsZXQgbGVnZW5kT3B0czogbGVnZW5kT3B0cyA9IHtcclxuICAgICAgZGF0YTogW11cclxuICAgIH1cclxuICAgIGxldCBzZXJpZXNPcHRzOiBBcnJheTxhbnk+ID0gW11cclxuICAgIGxldCB4QXhpc09wdHMgPSB7XHJcbiAgICAgIHR5cGU6ICdjYXRlZ29yeScsXHJcbiAgICAgIGRhdGE6IHJvd3MubWFwKChyb3c6IGFueSkgPT4gWEVVdGlscy5nZXQocm93LCBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eSkpXHJcbiAgICB9XHJcbiAgICBzZXJpZUNvbHVtbnMuZm9yRWFjaCgoY29sdW1uOiBhbnkpID0+IHtcclxuICAgICAgbGVnZW5kT3B0cy5kYXRhLnB1c2goY29sdW1uLnRpdGxlKVxyXG4gICAgICBzZXJpZXNPcHRzLnB1c2goe1xyXG4gICAgICAgIG5hbWU6IGNvbHVtbi50aXRsZSxcclxuICAgICAgICB0eXBlOiAnbGluZScsXHJcbiAgICAgICAgZGF0YTogcm93cy5tYXAoKHJvdzogYW55KSA9PiBYRVV0aWxzLmdldChyb3csIGNvbHVtbi5wcm9wZXJ0eSkpXHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gICAgbGV0IG9wdGlvbiA9IHtcclxuICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgIHRyaWdnZXI6ICdheGlzJ1xyXG4gICAgICB9LFxyXG4gICAgICBsZWdlbmQ6IGxlZ2VuZE9wdHMsXHJcbiAgICAgIHRvb2xib3g6IHtcclxuICAgICAgICBmZWF0dXJlOiB7XHJcbiAgICAgICAgICBzYXZlQXNJbWFnZToge31cclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIHhBeGlzOiB4QXhpc09wdHMsXHJcbiAgICAgIHlBeGlzOiB7XHJcbiAgICAgICAgdHlwZTogJ3ZhbHVlJ1xyXG4gICAgICB9LFxyXG4gICAgICBzZXJpZXM6IHNlcmllc09wdHNcclxuICAgIH1cclxuICAgIHJldHVybiBvcHRpb25cclxuICB9KSxcclxuICBDSEFSVF9QSUU6IGNyZWF0ZUNoYXJ0TW9kYWwoKHBhcmFtczogYW55KSA9PiB7XHJcbiAgICBjb25zdCB7ICR0YWJsZSwgbWVudSB9ID0gcGFyYW1zXHJcbiAgICBjb25zdCB7IHJvd3MsIGNvbHVtbnMgfSA9ICR0YWJsZS5nZXRTZWxlY3RlZFJhbmdlcyA/ICR0YWJsZS5nZXRTZWxlY3RlZFJhbmdlcygpIDogJHRhYmxlLmdldE1vdXNlQ2hlY2tlZHMoKVxyXG4gICAgY29uc3QgeyBwYXJhbXM6IGNoYXJ0UGFyYW1zID0ge30gfSA9IG1lbnVcclxuICAgIGNvbnN0IHsgY2F0ZWdvcnkgfSA9IGNoYXJ0UGFyYW1zXHJcbiAgICBsZXQgY2F0ZWdvcnlDb2x1bW4gPSAkdGFibGUuZ2V0Q29sdW1uQnlGaWVsZChjYXRlZ29yeSB8fCBjb2x1bW5zWzBdLnByb3BlcnR5KVxyXG4gICAgbGV0IHNlcmllQ29sdW1ucyA9IGNvbHVtbnMuZmlsdGVyKChjb2x1bW46IGFueSkgPT4gY29sdW1uLnByb3BlcnR5ICE9PSBjYXRlZ29yeUNvbHVtbi5wcm9wZXJ0eSlcclxuICAgIGxldCBzZXJpZUNvbHVtbiA9IHNlcmllQ29sdW1uc1swXVxyXG4gICAgbGV0IGxlZ2VuZERhdGEgPSByb3dzLm1hcCgocm93OiBhbnkpID0+IFhFVXRpbHMuZ2V0KHJvdywgY2F0ZWdvcnlDb2x1bW4ucHJvcGVydHkpKVxyXG4gICAgbGV0IHNlcmllc0RhdGE6IEFycmF5PGFueT4gPSBbXVxyXG4gICAgcm93cy5mb3JFYWNoKChyb3c6IGFueSkgPT4ge1xyXG4gICAgICBzZXJpZXNEYXRhLnB1c2goe1xyXG4gICAgICAgIG5hbWU6IFhFVXRpbHMuZ2V0KHJvdywgY2F0ZWdvcnlDb2x1bW4ucHJvcGVydHkpLFxyXG4gICAgICAgIHZhbHVlOiBYRVV0aWxzLmdldChyb3csIHNlcmllQ29sdW1uLnByb3BlcnR5KVxyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICAgIGxldCBvcHRpb24gPSB7XHJcbiAgICAgIHRvb2x0aXA6IHtcclxuICAgICAgICB0cmlnZ2VyOiAnaXRlbScsXHJcbiAgICAgICAgZm9ybWF0dGVyOiAne2F9IDxici8+e2J9IDoge2N9ICh7ZH0lKSdcclxuICAgICAgfSxcclxuICAgICAgbGVnZW5kOiB7XHJcbiAgICAgICAgdHlwZTogJ3Njcm9sbCcsXHJcbiAgICAgICAgb3JpZW50OiAndmVydGljYWwnLFxyXG4gICAgICAgIHJpZ2h0OiAxMCxcclxuICAgICAgICB0b3A6IDIwLFxyXG4gICAgICAgIGJvdHRvbTogMjAsXHJcbiAgICAgICAgZGF0YTogbGVnZW5kRGF0YVxyXG4gICAgICAgIC8vIHNlbGVjdGVkOiBkYXRhLnNlbGVjdGVkXHJcbiAgICAgIH0sXHJcbiAgICAgIHNlcmllczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIG5hbWU6IHNlcmllQ29sdW1uLnRpdGxlLFxyXG4gICAgICAgICAgdHlwZTogJ3BpZScsXHJcbiAgICAgICAgICByYWRpdXM6ICc1MCUnLFxyXG4gICAgICAgICAgY2VudGVyOiBbJzQwJScsICc1MCUnXSxcclxuICAgICAgICAgIGRhdGE6IHNlcmllc0RhdGFcclxuICAgICAgICB9XHJcbiAgICAgIF1cclxuICAgIH1cclxuICAgIHJldHVybiBvcHRpb25cclxuICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBjaGVja1ByaXZpbGVnZSAoaXRlbTogYW55LCBwYXJhbXM6IGFueSkge1xyXG4gIGNvbnN0IHsgJHRhYmxlIH0gPSBwYXJhbXNcclxuICBjb25zdCB7IGNvZGUsIHBhcmFtczogY2hhcnRQYXJhbXMgPSB7fSB9ID0gaXRlbVxyXG4gIHN3aXRjaCAoY29kZSkge1xyXG4gICAgY2FzZSAnQ0hBUlRfQkFSX1hfQVhJUyc6XHJcbiAgICBjYXNlICdDSEFSVF9CQVJfWV9BWElTJzpcclxuICAgIGNhc2UgJ0NIQVJUX0xJTkUnOiB7XHJcbiAgICAgIGNvbnN0IHsgcm93cywgY29sdW1ucyB9ID0gJHRhYmxlLmdldFNlbGVjdGVkUmFuZ2VzID8gJHRhYmxlLmdldFNlbGVjdGVkUmFuZ2VzKCkgOiAkdGFibGUuZ2V0TW91c2VDaGVja2VkcygpXHJcbiAgICAgIGNvbnN0IHsgY2F0ZWdvcnkgfSA9IGNoYXJ0UGFyYW1zXHJcbiAgICAgIGlmIChjYXRlZ29yeSkge1xyXG4gICAgICAgIGxldCBzZXJpZUNvbHVtbnMgPSBjb2x1bW5zLmZpbHRlcigoY29sdW1uOiBhbnkpID0+IGNvbHVtbi5wcm9wZXJ0eSAhPT0gY2F0ZWdvcnkpXHJcbiAgICAgICAgaXRlbS5kaXNhYmxlZCA9ICFyb3dzLmxlbmd0aCB8fCBzZXJpZUNvbHVtbnMubGVuZ3RoIDwgMVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGl0ZW0uZGlzYWJsZWQgPSAhcm93cy5sZW5ndGggfHwgY29sdW1ucy5sZW5ndGggPCAyXHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgICAgYnJlYWtcclxuICAgIGNhc2UgJ0NIQVJUX1BJRSc6IHtcclxuICAgICAgY29uc3QgeyByb3dzLCBjb2x1bW5zIH0gPSAkdGFibGUuZ2V0U2VsZWN0ZWRSYW5nZXMgPyAkdGFibGUuZ2V0U2VsZWN0ZWRSYW5nZXMoKSA6ICR0YWJsZS5nZXRNb3VzZUNoZWNrZWRzKClcclxuICAgICAgY29uc3QgeyBjYXRlZ29yeSB9ID0gY2hhcnRQYXJhbXNcclxuICAgICAgaWYgKGNhdGVnb3J5KSB7XHJcbiAgICAgICAgbGV0IHNlcmllQ29sdW1ucyA9IGNvbHVtbnMuZmlsdGVyKChjb2x1bW46IGFueSkgPT4gY29sdW1uLnByb3BlcnR5ICE9PSBjYXRlZ29yeSlcclxuICAgICAgICBpdGVtLmRpc2FibGVkID0gIXJvd3MubGVuZ3RoIHx8IHNlcmllQ29sdW1ucy5sZW5ndGggIT09IDFcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpdGVtLmRpc2FibGVkID0gIXJvd3MubGVuZ3RoIHx8IGNvbHVtbnMubGVuZ3RoICE9PSAyXHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgICAgYnJlYWtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUJlZm9yZURlc3Ryb3lFdmVudCAoeyAkdGFibGUgfTogYW55KSB7XHJcbiAgbGV0IHsgJFhNb2RhbCwgY2hhcnRNb2RhbHMgfSA9ICR0YWJsZVxyXG4gIGlmIChjaGFydE1vZGFscykge1xyXG4gICAgaWYgKCRYTW9kYWwuY2xvc2UpIHtcclxuICAgICAgY2hhcnRNb2RhbHMuZm9yRWFjaCgoaWQ6IHN0cmluZykgPT4gJFhNb2RhbC5jbG9zZShpZCkpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyDml6fniYjmnKzvvIzljbPlsIblup/lvINcclxuICAgICAgJFhNb2RhbC5jbG9zZUFsbCgpXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcml2aWxlZ2VFdmVudCAocGFyYW1zOiBhbnkpIHtcclxuICBwYXJhbXMub3B0aW9ucy5mb3JFYWNoKChsaXN0OiBBcnJheTxhbnk+KSA9PiB7XHJcbiAgICBsaXN0LmZvckVhY2goKGl0ZW06IGFueSkgPT4ge1xyXG4gICAgICBjaGVja1ByaXZpbGVnZShpdGVtLCBwYXJhbXMpXHJcbiAgICAgIGlmIChpdGVtLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgaXRlbS5jaGlsZHJlbi5mb3JFYWNoKChjaGlsZDogYW55KSA9PiB7XHJcbiAgICAgICAgICBjaGVja1ByaXZpbGVnZShjaGlsZCwgcGFyYW1zKVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIOWfuuS6jiB2eGUtdGFibGUg6KGo5qC855qE5Zu+6KGo5riy5p+T5o+S5Lu2XHJcbiAqL1xyXG5leHBvcnQgY29uc3QgVlhFVGFibGVQbHVnaW5DaGFydHMgPSB7XHJcbiAgaW5zdGFsbCAoeHRhYmxlOiB0eXBlb2YgVlhFVGFibGUpIHtcclxuICAgIGxldCB7IHYsIGludGVyY2VwdG9yLCBtZW51cywgX21vZGFsIH0gPSB4dGFibGVcclxuICAgIGlmICghX21vZGFsKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignW3Z4ZS10YWJsZS1wbHVnaW4tY2hhcnRzXSByZXF1aXJlIE1vZGFsIG1vZHVsZS4nKVxyXG4gICAgfVxyXG4gICAgaWYgKHYgIT09ICd2MicpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbdnhlLXRhYmxlLXBsdWdpbi1jaGFydHNdIFYyIHZlcnNpb24gaXMgcmVxdWlyZWQuJylcclxuICAgIH1cclxuICAgIGludGVyY2VwdG9yLmFkZCgnYmVmb3JlRGVzdHJveScsIGhhbmRsZUJlZm9yZURlc3Ryb3lFdmVudClcclxuICAgIGludGVyY2VwdG9yLmFkZCgnZXZlbnQuc2hvd01lbnUnLCBoYW5kbGVQcml2aWxlZ2VFdmVudClcclxuICAgIG1lbnVzLm1peGluKG1lbnVNYXApXHJcbiAgfVxyXG59XHJcblxyXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LlZYRVRhYmxlKSB7XHJcbiAgd2luZG93LlZYRVRhYmxlLnVzZShWWEVUYWJsZVBsdWdpbkNoYXJ0cylcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVlhFVGFibGVQbHVnaW5DaGFydHNcclxuIl19
